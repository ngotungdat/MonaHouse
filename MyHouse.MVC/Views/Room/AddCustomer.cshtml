<script src="~/house/lib/jqvmap/jquery.vmap.min.js"></script>
<link rel="~/house//stylesheet" href="assets/css/dashforge.dashboard.css">
<div class="container pd-x-0 pd-lg-x-10 pd-xl-x-0">
    <div class="d-sm-flex align-items-center justify-content-between ">
        <div>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb breadcrumb-style1 mg-b-10">
                    <li class="breadcrumb-item"><a href="#">Trang chủ</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Phòng số 01</li>
                </ol>
            </nav>
        </div>
    </div>
    <div id="js-step-goin" >
            <h3>Thông tin phòng</h3>
            <section>
                <div class="row mg-t-15">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="tx-12   tx-spacing-1 mg-b-5 tx-color-03">Loại thuê phòng</label>
                            <select name="" id="" class="form-control">
                                <option value="type-longday">Dài hạn</option>
                                <option value="type-shortday">Ngắn hạn</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="tx-12   tx-spacing-1 mg-b-5 tx-color-03">Gói điện nước</label>
                            <select name="" id="js-select-package" class="form-control">
                                <option value="type-all">Bao điện nước</option>
                                <option value="type-day" selected="">Theo ngày</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="tx-12   tx-spacing-1 mg-b-5 tx-color-03">Giá thuê</label>
                            <input type="tel" class="form-control" placeholder="0" data-type="currency" required="">
                        </div>
                    </div>

                    <div class="col-md-6 ">
                        <div class="form-group">
                            <label class="tx-12   tx-spacing-1 mg-b-5 tx-color-03">Ngày dọn vào</label>
                            <input type="text" class="form-control datetimepicker date-only" placeholder="0" required="" autocomplete="off">
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="tx-12   tx-spacing-1 mg-b-5 tx-color-03">Số điện</label>
                            <input type="tel" class="form-control  toggle-field" placeholder="Số ban đầu" data-type="number" required="">
                        </div>
                        <div class="upload-box">
                            <a href="javascript:;" class="btn btn-primary btn-upload d-block d-md-inline-block"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-camera mg-r-5"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg> Ảnh đồng hồ điện</a>
                            <input type="file" class="hidden upload-image-input toggle-field" accept="image/*" multiple="">
                            <div class="preview-image"></div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="tx-12   tx-spacing-1 mg-b-5 tx-color-03">Số nước</label>
                            <input type="tel" class="form-control  toggle-field" placeholder="Số ban đầu" data-type="number" required="">
                        </div>

                        <div class="upload-box">
                            <a href="javascript:;" class="btn btn-primary btn-upload d-block d-md-inline-block"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-camera mg-r-5"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg> Ảnh đồng hồ nước</a>
                            <input type="file" class="hidden upload-image-input  toggle-field" accept="image/*" multiple="">
                            <div class="preview-image"></div>
                        </div>
                    </div>
                    <div class="col-md-12 mg-t-30">
                        <div class="card ">
                            <div class="card-body">
                                <div class="list-services">
                                    <label class="tx-12   tx-spacing-1 mg-b-5 tx-color-03">Dịch vụ phòng</label>
                                    <div class="row align-items-center mg-b-20">
                                        <div class="col pl-r-5">
                                            <input type="tel" class="form-control" placeholder="Tên dịch vụ" ata-type="number" value="Wifi">
                                        </div>
                                        <div class="col pd-l-5">
                                            <input type="tel" class="form-control" placeholder="Giá" data-type="number" value="200.000">
                                        </div>
                                        <div class="col pd-l-0 flex-grow-0">
                                            <a href="javascript:;" class="tx-danger delete-service"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-minus-square"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="8" y1="12" x2="16" y2="12"></line></svg></a>
                                        </div>
                                    </div>
                                    <div class="row align-items-center mg-b-20">
                                        <div class="col pl-r-5">
                                            <input type="tel" class="form-control" placeholder="Tên dịch vụ" ata-type="number" value="Cáp">
                                        </div>
                                        <div class="col pd-l-5">
                                            <input type="tel" class="form-control" placeholder="Giá" data-type="number" value="200.000">
                                        </div>
                                        <div class="col pd-l-0 flex-grow-0">
                                            <a href="javascript:;" class="tx-danger delete-service"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-minus-square"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="8" y1="12" x2="16" y2="12"></line></svg></a>
                                        </div>
                                    </div>
                                </div>
                                <a href="javascript:;" class="btn btn-primary js-add-service "><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg> Thêm dịch vụ</a>
                            </div>
                        </div>

                    </div>

                </div>
            </section>
            <h3>Thông tin người thuê</h3>
            <section>
                <div class="row ">
                    <div class="col-sm form-group">
                        <label class="tx-12   tx-spacing-1 mg-b-5 tx-color-03">Họ và tên</label>
                        <input type="text" class="form-control" placeholder="Họ tên" required="">
                    </div>
                    <div class="col-sm form-group">
                        <label class="tx-12   tx-spacing-1 mg-b-5 tx-color-03">
                            Số điện
                            thoại
                        </label>
                        <input type="tel" class="form-control" placeholder="SĐT" data-type="number">
                    </div>
                    <div class="col-sm form-group">
                        <label class="tx-12   tx-spacing-1 mg-b-5 tx-color-03">
                            Địa chỉ
                            email
                        </label>
                        <input type="email" class="form-control" placeholder="0">
                    </div>

                </div>
                <div class="row ">
                    <div class="col-sm form-group">
                        <label class="tx-12   tx-spacing-1 mg-b-5 tx-color-03">Quê quán</label>
                        <input type="text" class="form-control" placeholder="Quê của bạn...">
                    </div>
                    <div class="col-sm form-group">
                        <label class="tx-12   tx-spacing-1 mg-b-5 tx-color-03">Số người ở</label>
                        <input type="tel" class="form-control" placeholder="0">
                    </div>
                    <div class="col-sm form-group">
                        <label class="tx-12   tx-spacing-1 mg-b-5 tx-color-03">Quan hệ</label>
                        <input type="text" class="form-control" placeholder="VD: Vợ chồng">
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        <div class="form-row">
                            <div class="col-12 upload-box mg-b-15">
                                <a href="javascript:;" class="btn btn-outline-primary btn-upload">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-camera mg-r-5"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg> Ảnh giấy tờ

                                </a>
                                <input type="file" class="hidden upload-image-input" accept="image/*" multiple="multiple">
                                <div class="preview-image"></div>
                            </div>
                        </div>
                    </div>

                </div>
            </section>

            <h3>Thanh toán</h3>
            <section>
                <div class="legend-box pd-15 pd-t-30 mg-b-30" data-label="Thông tin cấu hình">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="info-list">
                                <dl class="row-info">
                                    <dd class="">Giá phòng:</dd>
                                    <dt class="">3.500.000 / tháng</dt>
                                </dl>
                                <dl class="row-info">
                                    <dd class="">Giá điện / KW:</dd>
                                    <dt class=""><span class="tx-success">Đã bao gồm</span></dt>
                                </dl>
                                <dl class="row-info">
                                    <dd class="">Giá nước:</dd>
                                    <dt class=""><span class="tx-success">Đã bao gồm</span></dt>
                                </dl>
                                <dl class="row-info">
                                    <dd class="">Điện tháng trước:</dd>
                                    <dt class="">
                                        <span tabindex="0" role="button" data-toggle="popover" data-trigger="hover" title="" data-content="<strong>32323244</strong> <br/> Đã dùng: <strong>150 kW</strong>" data-original-title="Số điện tháng 3">
                                            2.000.000
                                            / 130 kW
                                        </span>
                                    </dt>
                                </dl>
                                <dl class="row-info">
                                    <dd class="">Nước tháng trước:</dd>
                                    <dt class="">
                                        <span tabindex="0" role="button" data-toggle="popover" data-trigger="hover" title="" data-content="<strong>32323244</strong> <br/> Đã dùng: <strong>150 kW</strong>" data-original-title="Số điện tháng 3">
                                            1.500.000
                                            / m<sup>3</sup>
                                        </span>
                                    </dt>
                                </dl>
                                <dl class="row-info mg-b-15 mg-md-b-0">
                                    <dd class="">Ngày dọn vào:</dd>
                                    <dt class=""><span class="">20/04/2020</span></dt>
                                </dl>

                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="info-list">
                                <dl class="row-info">
                                    <dd class="">Mạng:</dd>
                                    <dt class="">200.000</dt>
                                </dl>
                                <dl class="row-info">
                                    <dd class="">Rác:</dd>
                                    <dt class="">50.000</dt>
                                </dl>
                                <dl class="row-info">
                                    <dd class="">Giữ xe:</dd>
                                    <dt class="">150.000</dt>
                                </dl>

                                <dl class="row-info">
                                    <dd class="">Cáp TV:</dd>
                                    <dt class=""><span class="tx-second">100.000</span></dt>
                                </dl>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="legend-box pd-15" data-label="Thông tin thanh toán">
                    <div class="row">
                        <div class="col-sm-6 col-md-4">
                            <div class="form-group">
                                <label class="tx-12   tx-spacing-1 mg-b-5 tx-color-03">
                                    Cọc
                                    trước
                                </label>
                                <select name="" id="" class="form-control">
                                    <option value="1">1 tháng</option>
                                    <option value="2">2 tháng</option>
                                    <option value="3" selected="">3 tháng</option>
                                    <option value="4">4 tháng</option>
                                    <option value="5">5 tháng</option>
                                    <option value="6">6 tháng</option>
                                    <option value="7">7 tháng</option>
                                    <option value="8">8 tháng</option>
                                    <option value="9">9 tháng</option>
                                    <option value="10">10 tháng</option>
                                    <option value="11">11 tháng</option>
                                    <option value="12">12 tháng</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-4">
                            <div class="form-group">
                                <label class="tx-12   tx-spacing-1 mg-b-5 tx-color-03">
                                    Trả trước
                                    tới
                                </label>
                                <select name="" id="" class="form-control">
                                    <option value="1">Hết tháng 1</option>
                                    <option value="2">Hết tháng 2</option>
                                    <option value="3">Hết tháng 3</option>
                                    <option value="4" selected="">Hết tháng 4</option>
                                    <option value="5">Hết tháng 5</option>
                                    <option value="6">Hết tháng 6</option>
                                    <option value="7">Hết tháng 7</option>
                                    <option value="8">Hết tháng 8</option>
                                    <option value="9">Hết tháng 9</option>
                                    <option value="10">Hết tháng 10</option>
                                    <option value="11">Hết tháng 11</option>
                                    <option value="12">Hết tháng 12</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="tx-12   tx-spacing-1 mg-b-5 tx-color-03">
                                    Hình
                                    thức
                                </label>
                                <select name="" id="" class="form-control">
                                    <option value="" selected="">Chuyển khoản</option>
                                    <option value="">Tiền mặt</option>
                                </select>
                            </div>
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-md-8">
                            <div class="form-group">
                                <label class="tx-12   tx-spacing-1 mg-b-5 tx-color-03">
                                    Tổng
                                    tiền
                                </label>
                                <div class="input-group mg-b-10">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text" id="total-money">3 tháng 5 ngày = </span>
                                    </div>
                                    <input type="text" class="form-control bg-light tx-danger tx-bold" placeholder="Tổng tiền" aria-describedby="total-money" value="3.150.000" disabled="">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="tx-12   tx-spacing-1 mg-b-5 tx-color-03">
                                    Thực nhận của
                                    khách
                                </label>
                                <input type="text" class="form-control" placeholder="0">
                            </div>
                        </div>


                    </div>
                </div>

            </section>
        </div>
</div>
<script src="~/house/lib/jquery-steps/build/jquery.steps.min.js"></script>
<script src="~/house/lib/moment/moment.js"></script>
<script>
    function onBeforeSubmitForm(event, currentIndex) {
        let $currentStepForm = $('#js-step-goin-p-' + currentIndex);
        console.log($currentStepForm);
        let inputs = $currentStepForm.find('*:required');
        for (let i = 0; i < inputs.length; i++) {
            if (inputs[i].value === "") {
                $currentStepForm.addClass('was-validated');
                return false;
                break;
            }
        }
        $currentStepForm.addClass('was-validated');
        var data = [];
        $('.list-service').each(function (e) {
            var addon = {};
            addon["Name"] = $(this).find('.list-service-name').val();
            addon["Price"] = $(this).find('.list-service-price').val();
            data.push(addon);
        });
        $('input[name="hdfObjAddon"]').val(JSON.stringify(data));
        $('input[name="hdfStatusRent"]').val($('input[name="ck-regisRent"]').prop('checked'));
        var ListObject = [];
        $('.preview-image').each(function () {
            var object = {};
            var name = $(this).attr('data-name');
            object["Name"] = name;
            var listIMG = [];
            $(this).find('img').each(function (index, e) {
                listIMG.push({ "ID": $(e).attr('data-id'), "URL": $(e).attr('src') });
            });
            object["DataIMG"] = listIMG;
            ListObject.push(object);
        });
        console.log(JSON.stringify(ListObject))
        $('input[name="hdfObjIMG"]').val();
        $($('a[role="menuitem"]')[2]).css({ "opacity": "0.8", "pointer-events": "none", "cursor": "default" });
        $('#form-assign-renter').submit();

    }

    function onAfterSubmitForm() {
        alert('Chạy sau khi Submit form');
    }

    function checkrequired(event, currentIndex, newIndex) {
        if (currentIndex > newIndex) {
            return true;
        }
        let $currentStepForm = $('#js-step-goin-p-' + currentIndex);
        let inputs = $currentStepForm.find('*:required');
        for (let i = 0; i < inputs.length; i++) {
            if (inputs[i].value === "") {
                $currentStepForm.addClass('was-validated');
                return false;
                break;
            }
        }
        $currentStepForm.addClass('was-validated');
        return true;
    }
    function initForm() {
        $('#js-step-goin').steps({
            headerTag: 'h3',
            bodyTag: 'section',
            transitionEffect: 'fade',
            transitionEffectSpeed: 200,
            stepsOrientation: "vertical",
            autoFocus: true,
            labels: {
                cancel: 'Huỷ',
                next: 'Tiếp tục',
                previous: 'Quay lại',
                finish: 'Xong',
            },
            titleTemplate: '<span class="number">#index#</span> <span class="title">#title#</span>',
            startIndex: 0,
            onStepChanging: checkrequired,
            onFinishing: onBeforeSubmitForm,
            //onFinished:onAfterSubmitForm
        });
    }
    initForm();
    $(document).ready(function () {

        $('.js-add-service').on('click', function () {
            const html = ` <div class="row align-items-center mg-b-20">
                            <div class="col pl-r-5">
                                <input type="tel" class="form-control" placeholder="Tên dịch vụ" ata-type="number" value="">
                            </div>
                            <div class="col pd-l-5">
                                <input type="tel" class="form-control" placeholder="Giá" data-type="number" value="">
                            </div>
                            <div class="col pd-l-0 flex-grow-0">
                                <a href="javascript:;" class="tx-danger delete-service"><i data-feather="minus-square"></i></a>
                            </div>
                        </div>`;
            $('.list-services').append(html);
            feather.replace();
        });
        $('.list-services').on('click', '.delete-service', function () {
            $(this).closest('.row').remove();
        });
        // $('#js-select-package').on('change', function(e) {
        //     let $fields = $('.toggle-field');
        //     let $upload = $('.upload-box');
        //     let value = $(this).val();
        //     console.log($fields);
        //     switch (value) {
        //         case 'type-all': {
        //             $fields.prop('disabled', true);
        //             $fields.addClass('disabled');
        //             $fields.attr('placeholder', 'Đã bao gồm tiền phòng');
        //             $upload.fadeOut();
        //             break;
        //         }
        //         case 'type-day': {
        //             $fields.removeClass('disabled');
        //             $fields.prop('disabled', false);
        //             $fields.attr('placeholder', 'Số ban đầu');
        //             $upload.fadeIn();
        //             break;
        //         }
        //     }
        // });
    });
</script>
