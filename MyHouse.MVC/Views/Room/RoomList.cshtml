@model CoreModel
<style>
    /*input.form-control:disabled {
        background: none;
    }*/

    .room .room-header a.item-link {
        color: #46CED0;
    }

    .room-header .dropdown__wrap {
        right: 15px;
        position: absolute;
    }

    .room .room-info {
        padding-top: 30px;
    }

    .result-goout .tx-row .lb {
        flex: 0 0 250px;
    }

    .room .lb {
        margin-bottom: 2px;
    }

    .ls-room {
        text-align: left;
    }

    .form-control {
        height: initial;
    }

    .input-group-text {
        padding: initial;
    }

    .sticky-top {
        background: white;
    }

    .content-fixed {
        margin-top: 0px;
    }

        .content-fixed a {
            text-decoration: none;
        }

    .tbody-roomlist {
        border-top: none;
    }

    .table > :not(:first-child) {
        border-top: 1px solid currentColor;
    }

    .table-striped tbody tr:nth-of-type(2n+1) {
        background-color: #f3f4f7;
    }
    /* BaoNguyen CSS*/
    .col-sm-12 {
        padding-bottom: 15px;
    }
    .col-sm-6 {
        margin-bottom: 20px;
    }
</style>
<div class="content content-fixed">
    <div class="fixed-filter sticky-top">
        <div class="container pd-x-0 pd-lg-x-10 pd-xl-x-0">
            <div class="d-flex align-items-center justify-content-between flex-wrap">
                <h4 class="mg-b-15 tx-spacing--1">Danh sách phòng</h4>
                <div class="d-flex align-items-center">
                    <div class="d-flex">
                        <div class="form-group mg-r-15 group-select" style="background-color:white;">
                            <a href="javascript:;" class="btn btn-primary btn-add-room" data-toggle="modal"><i class="fas fa-plus-circle"></i> Thêm Phòng</a>
                        </div>
                        <div class="form-group mg-r-15 group-select">
                            <label class="mg-b-0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg></label>
                            <select id="branch-search-main" name="branch-search-main" class="form-control" onchange="sort_data_Branch(this.value)" >
                                
                            </select>
                        </div>
                        <div class="form-group group-select">
                            <label class="mg-b-0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg></label>
                            <select name="" class="form-control">
                                <option value="">Tháng 1</option>
                                <option value="" selected="">Tháng 2</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal thêm phòng -->
    <div class="modal fade modal-nopadding-right" id="modal-room" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered wd-sm-650" role="document">
            <div class="modal-content">
                <div class="modal-header pd-y-20 pd-x-20 pd-sm-x-30">
                    <a href="" role="button" class="close pos-absolute t-15 r-15" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </a>
                    <div class="media align-items-center">
                        <span class="tx-color-03 d-none d-sm-block"><i class="fas fa-booth-curtain"></i></span>
                        <div class="media-body mg-sm-l-20">
                            <input type="hidden" name="hdfId" value="0" />
                            <h4 class="tx-18 tx-sm-20 mg-b-2 tx-uppercase">Phòng</h4>
                            <p class="tx-13 tx-color-03 mg-b-0">Thêm Phòng</p>
                        </div>
                    </div><!-- media -->
                </div><!-- modal-header -->
                <div class="modal-body pd-sm-t-30 pd-sm-x-30">
                    <input type="hidden" name="hdfId" value="0" />
                    <div class="form-group">
                        <div class="row">
                            <div class="col-sm-6">
                                <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Tên Phòng<span class="text-danger">(*)</span></label>
                                <input type="text" name="txt-room-name" required class="form-control" placeholder="Ví dụ: Phòng số 1">
                            </div>
                            <div class="col-sm-6">
                                <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Chọn tòa nhà<span class="text-danger">(*)</span></label>
                                <select class="js-example-basic-single form-control select2" name="ListBranch" id="ListBranch">
                                    <option disabled selected>--- Chọn tòa nhà ---</option>
                                </select>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-6">
                                <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Giá phòng (vnd)<span class="text-danger">(*)</span></label>
                                <input type="text" name="txt-room-price" data-type="currency" required class="form-control" placeholder="Ví dụ: 2.000.000 đ">
                            </div>
                            <div class="col-sm-6">
                                <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Chọn tầng<span class="text-danger">(*)</span></label>
                                <select class="js-example-basic-single form-control select2" name="ListFloor" id="ListFloor">
                                    <option disabled selected>--- Chọn tầng ---</option>
                                </select>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-6">
                                <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Tiền cọc<span class="text-danger">(*)</span></label>
                                <input type="text" name="txt-deposit" data-type="currency" required class="form-control" placeholder="Ví dụ: 2.000.000d">
                            </div>
                            <div class="col-sm-6">
                                <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Chọn loại phòng<span class="text-danger">(*)</span></label>
                                <select class="js-example-basic-single form-control select2" name="ListRoomType" id="ListRoomType">
                                    <option disabled selected>--- Chọn Loại ---</option>
                                </select>
                            </div>

                        </div>
                        @*<div class="row">
                                <div class="col-sm-12">
                                    <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Ngày Phòng trống khách<span class="text-danger">(*)</span></label>
                                    <input type="text" name="txt-EmptyRoomDate" required class="form-control" placeholder="Ví dụ: 20/2/2023">
                                </div>
                            </div>*@

                        <div class="row">
                            <div class="col-sm-6">
                                <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Số lượng giường<span class="text-danger">(*)</span></label>
                                <input type="text" name="txt-BedAmount" data-type="number" required class="form-control" placeholder="Ví dụ: 2 giường">
                            </div>
                            <div class="col-sm-6">
                                <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Trạng thái phòng<span class="text-danger">(*)</span></label>
                                <select class="js-example-basic-single form-control select2" name="room-status" id="room-status">
                                    <option disabled selected>--- Trạng thái ---</option>
                                    <option value="0">Phòng trống</option>
                                    <option value="1">Sắp chuyển vào</option>
                                    <option value="2">Đang thuê</option>
                                    <option value="3">Sắp dọn ra</option>
                                </select>
                            </div>
                        </div><div class="row">

                            <div class="col-sm-6">
                                <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Diện tích phòng<span class="text-danger">(*)</span></label>
                                <input type="text" name="txt-Acreage" data-type="currency" required class="form-control" placeholder="Ví dụ: 30 m2">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-12">
                                <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Chọn hình ảnh<span class="text-danger">(*)</span></label>
                                <div style="clear:left;"></div>
                                <a href="javascript:;" class="btn btn-outline-primary btn-uploads btn-block">
                                    <i data-feather="camera" class="mg-r-5"></i> Ảnh nhà - dãy trọ
                                </a>
                                <input id="input-img" type='file' name="electricimg" class="hidden upload-image-temps remove-items" onchange="readURL(this,'input-img','room-img');" multiple />
                                <div style="clear:left;"></div>
                                <div class="preview-image" id="room-img"></div>

                            </div>
                        </div>
                    </div>
                </div><!-- modal-body -->
                <div class="modal-footer pd-x-20 pd-y-15">
                    <button type="button" class="btn btn-white" data-dismiss="modal">Huỷ</button>
                    <button type="button" class="btn btn-primary btn-save-room">Lưu lại</button>
                </div>
            </div><!-- modal-content -->
        </div><!-- modal-dialog -->
    </div><!-- modal -->
    <!--modal Image-->
    <div class="modal fade modal-nopadding-right" id="modal-room-image" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered wd-sm-650" role="document">
            <div class="modal-content">
                <div class="modal-header pd-y-20 pd-x-20 pd-sm-x-30">
                    <a href="" role="button" class="close pos-absolute t-15 r-15" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </a>
                    <div class="media align-items-center">
                        <span class="tx-color-03 d-none d-sm-block"><i class="fas fa-image"></i></span>
                        <div class="media-body mg-sm-l-20">
                            <h4 class="tx-18 tx-sm-20 mg-b-2 tx-uppercase">Hình ảnh phòng</h4>
                            <p class="tx-13 tx-color-03 mg-b-0">hình ảnh chi tiết</p>
                        </div>
                    </div><!-- media -->
                </div><!-- modal-header -->
                <div class="modal-body pd-sm-t-30 pd-sm-x-30">
                    <div class="row">
                        <input type="hidden" id="hdfId-update-room-image" value="0" />
                        <div class="col-sm-12">
                            <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Chọn hình ảnh<span class="text-danger">(*)</span></label>
                            <div style="clear:left;"></div>
                            <a href="javascript:;" class="btn btn-outline-primary btn-uploads-edit btn-block">
                                <i data-feather="camera" class="mg-r-5"></i> Ảnh nhà - dãy trọ
                            </a>
                            <input id="input-img-edit" type='file' name="electricimg" class="hidden upload-image-temps-edit remove-items" onchange="readURL(this,'input-img-edit','image-byroomidEdit');" multiple />
                            <div style="clear:left;"></div>
                            <div class="preview-image" id="image-byroomid"></div>
                            <div class="preview-image" id="image-byroomidEdit"></div>

                        </div>
                    </div>

                </div>
                <!-- modal-body -->
                <div class="modal-footer pd-x-20 pd-y-15">
                    <button type="button" class="btn btn-white" data-dismiss="modal">Huỷ</button>
                    <button type="button" class="btn btn-primary btn-save-image-edit">Lưu lại</button>
                </div>
            </div><!-- modal-content -->
        </div><!-- modal-dialog -->
    </div><!-- modal -->
    <!--modal Edit Room-->
    <div class="modal fade modal-nopadding-right" id="modal-room-edit" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered wd-sm-650" role="document">
            <div class="modal-content">
                <div class="modal-header pd-y-20 pd-x-20 pd-sm-x-30">
                    <a href="" role="button" class="close pos-absolute t-15 r-15" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </a>
                    <div class="media align-items-center">
                        <span class="tx-color-03 d-none d-sm-block"><i class="fas fa-booth-curtain"></i></span>
                        <div class="media-body mg-sm-l-20">
                            <input type="hidden" name="hdfId" value="0" />
                            <h4 class="tx-18 tx-sm-20 mg-b-2 tx-uppercase">Phòng</h4>
                            <p class="tx-13 tx-color-03 mg-b-0">Sửa Phòng</p>
                        </div>
                    </div><!-- media -->
                </div><!-- modal-header -->
                <div class="modal-body pd-sm-t-30 pd-sm-x-30">
                    <input type="hidden" name="hdfId" id="hdfId" value="0" />
                    <div class="form-group">
                        <div class="row">
                            <div class="col-sm-6">
                                <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Tên Phòng<span class="text-danger">(*)</span></label>
                                <input type="text" name="txt-room-name-edit" required class="form-control" placeholder="Ví dụ: Phòng số 1">
                            </div>
                            <div class="col-sm-6">
                                <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Chọn tòa nhà<span class="text-danger">(*)</span></label>
                                <select class="js-example-basic-single form-control select2" name="ListBranch-edit" id="ListBranch-edit">
                                    <option disabled="true" selected>Chọn tòa nhà</option>
                                </select>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-6">
                                <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Giá phòng (vnd)<span class="text-danger">(*)</span></label>
                                <input type="text" name="txt-room-price-edit" data-type="currency" required class="form-control" placeholder="Ví dụ: 2.000.000 đ">
                            </div>
                            <div class="col-sm-6">
                                <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Chọn tầng<span class="text-danger">(*)</span></label>
                                <select class="js-example-basic-single form-control select2" name="ListFloor-edit" id="ListFloor-edit">
                                    <option disabled="true" selected>Chọn tầng</option>
                                </select>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-6">
                                <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Tiền cọc<span class="text-danger">(*)</span></label>
                                <input type="text" name="txt-deposit-edit" data-type="currency" required class="form-control" placeholder="Ví dụ: 2.000.000d">
                            </div>
                            <div class="col-sm-6">
                                <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Chọn loại phòng<span class="text-danger">(*)</span></label>
                                <select class="js-example-basic-single form-control select2" name="ListRoomType-edit" id="ListRoomType-edit">
                                    <option disabled="true" selected>Chọn Loại</option>
                                </select>
                            </div>

                        </div>
                        @*<div class="row">
                                <div class="col-sm-12">
                                    <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Ngày Phòng trống khách<span class="text-danger">(*)</span></label>
                                    <input type="text" name="txt-EmptyRoomDate" required class="form-control" placeholder="Ví dụ: 20/2/2023">
                                </div>
                            </div>*@

                        <div class="row">
                            <div class="col-sm-6">
                                <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Số lượng giường<span class="text-danger">(*)</span></label>
                                <input type="text" name="txt-BedAmount-edit" data-type="number" required class="form-control" placeholder="Ví dụ: 2 giường">
                            </div>
                            <div class="col-sm-6">
                                <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Trạng thái phòng<span class="text-danger">(*)</span></label>
                                <select class="js-example-basic-single form-control select2" name="room-status-edit" id="room-status-edit">
                                    <option disabled="true" selected>Trạng thái</option>
                                    <option value="0">Phòng Chống</option>
                                    <option value="1">Sắp chuyển vào</option>
                                    <option value="2">Đang thuê</option>
                                    <option value="3">Sắp dọn ra</option>
                                </select>
                            </div>
                        </div><div class="row">

                            <div class="col-sm-6">
                                <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Diện tích phòng<span class="text-danger">(*)</span></label>
                                <input type="text" name="txt-Acreage-edit" data-type="currency" required class="form-control" placeholder="Ví dụ: 30 m2">
                            </div>
                        </div>

                    </div>
                </div><!-- modal-body -->
                <div class="modal-footer pd-x-20 pd-y-15">
                    <button type="button" class="btn btn-white" data-dismiss="modal">Huỷ</button>
                    <button type="button" class="btn btn-primary btn-save-room-edit">Lưu lại</button>
                </div>
            </div><!-- modal-content -->
        </div><!-- modal-dialog -->
    </div><!-- modal -->
    <!--Modal tiền điện-->
    <div class="modal fade show" id="js-electronicNote" aria-modal="true" style="padding-right: 17px;" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header ">
                    <a href="" role="button" class="close pos-absolute t-15 r-15" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </a>
                    <div class="media align-items-center">
                        <span class="tx-color-03 d-none d-sm-block"><i class="fas fa-calendar-alt tx-24 tx-color-03" aria-hidden="true"></i></span>
                        <div class="media-body mg-sm-l-20">
                            <h4 class="tx-18 tx-sm-20 mb-0">Phòng số 01</h4>
                        </div>
                    </div><!-- media -->
                </div><!-- modal-header -->
                <div class="modal-body ">
                    <div class="d-flex align-items-center owner-wrap mg-b-15">
                        <input type="hidden" id="electric-price-for-bill" />
                        <input type="hidden" id="water-price-for-bill" />
                        @*<div class="owner-avatar d-flex align-items-center">
                            <span class="avatar overflow-hidden rounded-circle">
                                <img src="assets/img/teacher.jpg" alt="avatar">
                            </span>
                        </div>*@
                       @* <div class="owner-info d-flex align-items-center justify-content-between pd-l-10 flex-grow-1">
                            <div class="info">
                                <p class="name mg-b-0 tx-color-01 tx-medium">Trương Văn Lam</p>
                                <p class="affliate mg-b-0 mg-t-0 "><a href="mailto:vanlam@gmail.com" class="tx-color-03">vanlam@gmail.com</a></p>
                            </div>
                            <div class="quick-contact">
                                <a href="tel:+84886706289"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-phone"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg></a>
                            </div>
                        </div>*@
                    </div>
                    <div class="form-row">
                        <div class="col-sm-6  form-group">
                            <label class="tx-10 tx-spacing-1 mg-b-5 tx-color-03">Điện tháng trước</label>
                            <input id="electric-old-number"type="tel" class="form-control number-val" placeholder="Trống" >
                        </div>
                        <div class="col-sm-6  form-group">
                            <label class="tx-10 tx-spacing-1 mg-b-5 tx-color-03">Điện tháng này</label>
                            <input id="electric-new-number" type="tel" class="form-control number-val" placeholder="Trống">
                        </div>
                        <div class="col-12 upload-box mg-b-20">
                            <a href="javascript:;" class="btn btn-outline-primary btn-upload btn-block"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-camera mg-r-5"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg> Ảnh đồng hồ điện</a>
                            <input id="image-electric" type="file" class="hidden upload-image-input" accept="image/*">
                            <div class="preview-image"></div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="col-sm-6  form-group">
                            <label class="tx-10 tx-spacing-1 mg-b-5 tx-color-03">Nước tháng trước</label>
                            <input id="water-old-number" type="tel" class="form-control number-val" placeholder="Trống">
                        </div>
                        <div class="col-sm-6  form-group">
                            <label class="tx-10 tx-spacing-1 mg-b-5 tx-color-03">Nước tháng này</label>
                            <input id="water-new-number" type="tel" class="form-control number-val" placeholder="Trống">
                        </div>
                        <div class="col-12 upload-box mg-b-20">
                            <a href="javascript:;" class="btn btn-outline-primary btn-upload btn-block"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-camera mg-r-5"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg> Ảnh đồng hồ nước</a>
                            <input id="image-water" type="file" class="hidden upload-image-input" accept="image/*">
                            <div class="preview-image"></div>
                        </div>
                    </div>

                </div><!-- modal-body -->
                <div class="modal-footer pd-x-20 pd-y-15">
                    <button type="button" class="btn btn-white" data-dismiss="modal">Huỷ</button>
                    <button type="button" class="btn btn-primary electric-water-update">Cập nhật</button>
                </div>
            </div><!-- modal-content -->
        </div><!-- modal-dialog -->
    </div>
    <!-- Modal tinh tien-->
    <div class="modal fade show" id="js-payMoney" style=" padding-right: 17px;" tabindex="-1" role="dialog" aria-hidden="true" aria-modal="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header ">
                    <a href="" role="button" class="close pos-absolute t-15 r-15" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </a>
                    <div class="media align-items-center">
                        <span class="tx-color-03 d-none d-sm-block"><i class="fas fa-calendar-alt tx-24 tx-color-03" aria-hidden="true"></i></span>
                        <div class="media-body mg-sm-l-20">
                            <h4 class="tx-18 tx-sm-20 mb-0">Phòng số 01</h4>
                        </div>
                    </div><!-- media -->
                </div><!-- modal-header -->
                <div class="modal-body ">
                    <div class="d-flex align-items-center owner-wrap mg-b-15">

                        <div class="owner-info d-flex align-items-center justify-content-between pd-l-10 flex-grow-1">
                            <div class="info">
                                <p class="name mg-b-0 tx-color-01 tx-medium">Trương Văn Lam</p>
                                <p class="affliate mg-b-0 mg-t-0 "><a href="mailto:vanlam@gmail.com" class="tx-color-03">vanlam@gmail.com</a></p>
                            </div>
                            <div class="quick-contact">
                                <a href="tel:+84886706289"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-phone"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg></a>
                            </div>
                        </div>
                    </div>
                    <div class="row mg-b-15  align-items-center">
                        <input type="hidden" id="room-id-checkout-month" />
                        <div class="col-sm-6">
                            <select name="ddl-year" id="ddl-year" class="form-control">
                            </select>
                        </div>
                        <div class="col-sm-6">
                            <select name="ddl-month" id="ddl-month" class="form-control">
                            </select>
                        </div>
                    </div>

                    <div class="row">
                        <table class="table  valign-center tx-nowrap table-striped tx-center">
                            @*<caption class="tx-left-f mg-b-0-f">Lịch sử thanh toán</caption>*@
                            <thead class="valign-middle">
                                <tr>
                                    <th>Ngày ghi</th>
                                    <th>Số điện tiêu thụ</th>
                                    <th><span class="">Số nước tiêu thụ<span></span></span></th>
                                    <th><span class="">Giá điện</span></th>
                                    <th><span class="">Giá nước</span></th>
                                    <th><span class="">Tiền điện</span></th>
                                    <th><span class="">Tiền nước</span></th>
                                </tr>
                            </thead>
                            <tbody id="electric-water-bill">
                            </tbody>
                        </table>
                    </div>
                    <div class="row">
                        <div class="col">
                            <span class="lb">Tiền điện theo tháng :</span>
                        </div>
                        <div class="col tx-right">
                            <span class="value tx-color-01 tx-medium" id="electric-bill-with-month"> <sup>đ</sup></span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <span class="lb">Tiền nước theo tháng:</span>
                        </div>
                        <div class="col tx-right">
                            <span class="value tx-color-01 tx-medium" id="water-bill-with-month"><sup>đ</sup></span>
                        </div>
                    </div>
                    <hr class="mg-b-15 mg-t-5">
                    <div class="row">
                        <table class="table  valign-center tx-nowrap table-striped tx-center">
                            @*<caption class="tx-left-f mg-b-0-f">Lịch sử thanh toán</caption>*@
                            <thead class="valign-middle">
                                <tr>
                                    <th>Tên dịch vụ</th>
                                    <th>Phí dịch vụ</th>
                                </tr>
                            </thead>
                            <tbody id="room-ultilities-checkout">
                            </tbody>
                        </table>
                    </div>
                    <div class="row">
                        <div class="col">
                            <span class="lb">Phí Dịch vụ:</span>
                        </div>
                        <div class="col tx-right">
                            <span class="value tx-color-01 tx-medium" id="room-utilities-bill"><sup>đ</sup></span>
                        </div>
                    </div>
                    <hr class="mg-b-15 mg-t-5">
                    <div class="row mg-b-10">
                        <div class="col">
                            <span class="lb tx-medium">Giá phòng:</span>
                        </div>
                        <div class="col tx-right">
                            <span class="value tx-color-03 tx-medium tx-danger" id="room-price-checkout"> <sup>đ</sup></span>
                        </div>
                    </div>
                    <hr class="mg-b-15 mg-t-5">
                    <div class="row mg-b-10">
                        <div class="col">
                            <span class="lb tx-medium">Tổng thu:</span>
                        </div>
                        <div class="col tx-right">
                            <span class="value tx-color-03 tx-medium tx-danger" id="total-money-checkout"><sup>đ</sup></span>
                        </div>
                    </div>
                    <div class="row mg-b-10 align-items-center">
                        <div class="col">
                            <span class="lb">Chi phí phát sinh:</span>
                        </div>
                        <div class="col">
                            <input id="price-plus" type="tel" data-type="currency" class="form-control" placeholder="0" value="0">
                        </div>

                    </div>
                    <div class="row mg-b-10 align-items-center">
                        <div class="col">
                            <span class="lb">Số tiền được giảm:</span>
                        </div>
                        <div class="col">
                            <input id="price-subtract" type="tel" data-type="currency" class="form-control" placeholder="0" value="0">
                        </div>

                    </div>
                    <div class="row mg-b-10">
                        <div class="col">
                            <span class="lb tx-medium">Tổng nhận:</span>
                        </div>
                        <div class="col tx-right">
                            <span id="total-money-after-edit" class="value tx-color-03 tx-medium tx-danger"> <sup>đ</sup></span>
                        </div>
                    </div>
                    <hr class="mg-b-15 mg-t-5">
                    <div class="row mg-b-10 align-items-center">
                        <div class="col">
                            <span class="lb">Ghi chú:</span>
                        </div>
                        <div class="col">
                            <textarea id="note-checkout" class="form-control" placeholder="ghi chú"></textarea>
                        </div>

                    </div>
                    @*<div class="row mg-b-10 align-items-center">
            <div class="col">
                <span class="lb">Đã nhận:</span>
            </div>
            <div class="col">
                <input type="tel" data-type="currency" class="form-control" placeholder="0">
            </div>

        </div>
        <div class="row mg-b-10 align-items-center">
            <div class="col">
                <span class="lb">Hình thức:</span>
            </div>
            <div class="col">
                <select name="" class="form-control">
                    <option value="" selected="">Chuyển khoản</option>
                    <option value="">Tiền mặt</option>
                </select>
            </div>
        </div>*@

                </div><!-- modal-body -->
                <div class="modal-footer pd-x-20 pd-y-15">
                    <button type="button" class="btn btn-white" data-dismiss="modal">Huỷ</button>
                    <button type="button" class="btn btn-primary btn-checkout">Lưu lại</button>
                </div>
            </div><!-- modal-content -->
        </div><!-- modal-dialog -->
    </div>
    <!--modal don ra -->
    <div class="modal fade show" id="js-goOut" style=" padding-right: 17px;" tabindex="-1" role="dialog" aria-hidden="true" aria-modal="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header ">
                    <a href="" role="button" class="close pos-absolute t-15 r-15" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </a>
                    <div class="media align-items-center">
                        <span class="tx-color-03 d-none d-sm-block"><i class="fas fa-calendar-alt tx-24 tx-color-03" aria-hidden="true"></i></span>
                        <div class="media-body mg-sm-l-20">
                            <h4 class="tx-18 tx-sm-20 mb-0">Phòng số 01</h4>
                        </div>
                    </div><!-- media -->
                </div><!-- modal-header -->
                <div class="modal-body ">
                    <div class="d-flex align-items-center owner-wrap mg-b-15">
                        <div class="owner-avatar d-flex align-items-center">
                            <span class="avatar overflow-hidden rounded-circle">
                                <img src="assets/img/teacher.jpg" alt="avatar">
                            </span>
                        </div>
                        <div class="owner-info d-flex align-items-center justify-content-between pd-l-10 flex-grow-1">
                            <div class="info">
                                <p class="name mg-b-0 tx-color-01 tx-medium">Trương Văn Lam</p>
                                <p class="affliate mg-b-0 mg-t-0 "><a href="mailto:vanlam@gmail.com" class="tx-color-03">vanlam@gmail.com</a></p>
                            </div>
                            <div class="quick-contact">
                                <a href="tel:+84886706289"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-phone"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg></a>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label class="tx-10 tx-spacing-1 mg-b-5 tx-color-03">Ngày dọn vào</label>
                                <div class="input-icon">
                                    <input type="tel" class="form-control datetimepicker date-only" placeholder="dd/mm/yyyy" value="20/10/2019" disabled="" autocomplete="off">
                                    <a href="javascript:;" class="datepicker-trigger icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg></a>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label class="tx-10 tx-spacing-1 mg-b-5 tx-color-03">Ngày dọn ra</label>
                                <div class="input-icon">
                                    <input type="tel" class="form-control datetimepicker date-only" placeholder="dd/mm/yyyy" value="20/10/2019" readonly="true" autocomplete="off">
                                    <a href="javascript:;" class="datepicker-trigger icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg></a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="form-row">
                                <div class="col-12 form-group">
                                    <label class="tx-10 tx-spacing-1 mg-b-5 tx-color-03">Điện tháng này</label>
                                    <input type="tel" class="form-control number-val" placeholder="Trống">
                                </div>
                                <div class="col-12 upload-box mg-b-15">
                                    <a href="javascript:;" class="btn btn-outline-primary btn-upload btn-block"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-camera mg-r-5"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg> Ảnh đồng hồ điện</a>
                                    <input type="file" class="hidden upload-image-input" accept="image/*">
                                    <div class="preview-image"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">

                            <div class="form-row">
                                <div class="col-12 form-group">
                                    <label class="tx-10 tx-spacing-1 mg-b-5 tx-color-03">Nước tháng này</label>
                                    <input type="tel" class="form-control number-val" placeholder="Trống">
                                </div>
                                <div class="col-12 upload-box mg-b-15">
                                    <a href="javascript:;" class="btn btn-outline-primary btn-upload btn-block"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-camera mg-r-5"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg> Ảnh đồng hồ nước</a>
                                    <input type="file" class="hidden upload-image-input" accept="image/*">
                                    <div class="preview-image"></div>
                                </div>
                            </div>
                        </div>
                    </div>


                </div><!-- modal-body -->
                <div class="modal-footer pd-x-20 pd-y-15">
                    <button type="button" class="btn btn-white" data-dismiss="modal">Huỷ</button>
                    <button type="button" class="btn btn-primary">Lưu lại</button>
                    <button type="button" class="btn btn-success" data-toggle="modal" data-target="#js-goOut-success" data-dismiss="modal">Thu tiền</button>
                </div>
            </div><!-- modal-content -->
        </div><!-- modal-dialog -->
    </div>
    <!--Modal tien ich-->
    <div class="modal fade show" id="js-edit-service" padding-right: 17px;" aria-modal="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header ">
                    <a href="" role="button" class="close pos-absolute t-15 r-15" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </a>
                    <div class="media align-items-center">
                        <span class="tx-color-03 d-none d-sm-block"><i class="fas fa-calendar-alt tx-24 tx-color-03" aria-hidden="true"></i></span>
                        <div class="media-body mg-sm-l-20">
                            <h4 class="tx-18 tx-sm-20 mb-0">Dịch vụ và phí</h4>
                        </div>
                    </div><!-- media -->
                </div><!-- modal-header -->
                <div class="modal-body ">
                    <div class=" room-info">
                        <div class="row">

                            @*<div class="col-md-6 ">
                                <div class="row form-group">
                                    <div class="wd-120 col col-form-label">
                                        <span class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">
                                            Giá
                                            phòng / tháng:
                                        </span>
                                    </div>
                                    <div class="flex-grow-1 col input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-dollar-sign wd-20 ht-20"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg></span>
                                        </div>
                                        <input type="tel" placeholder="Số nước" class="form-control" value="3.500.000" data-type="currency">
                                    </div>
                                </div>
                            </div>*@


                            <div class="col-md-6 ">
                                <div class="row form-group">
                                    <div class="wd-120 col col-form-label">
                                        <span class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">
                                            Giá
                                            điện / kW:
                                        </span>
                                    </div>
                                    <div class="flex-grow-1 col input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-zap wd-20 ht-20"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg></span>
                                        </div>
                                        <input id="electric-price" type="tel" placeholder="Số điện" class="form-control" data-type="currency" >
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 ">
                                <div class="row form-group">
                                    <div class="wd-120 col col-form-label">
                                        <span class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">
                                            Giá
                                            nước / m<sup>3</sup>:
                                        </span>
                                    </div>
                                    <div class="flex-grow-1 col input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-droplet wd-20 ht-20"><path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"></path></svg></span>
                                        </div>
                                        <input id="water-price" type="tel" placeholder="Số nước" class="form-control" data-type="currency" >
                                    </div>
                                </div>
                            </div>
                            @*<div class="col-md-6 ">
                                <div class="row form-group">
                                    <div class="wd-120 col col-form-label">
                                        <span class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">
                                            Điện
                                            tháng trước:
                                        </span>
                                    </div>
                                    <div class="flex-grow-1 col input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-dollar-sign wd-20 ht-20"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg></span>
                                        </div>
                                        <input type="tel" placeholder="Số nước" class="form-control" value="3.500.000" data-type="currency">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 ">
                                <div class="row form-group">
                                    <div class="wd-120 col col-form-label">
                                        <span class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">
                                            Nước
                                            tháng trước:
                                        </span>
                                    </div>
                                    <div class="flex-grow-1 col input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-dollar-sign wd-20 ht-20"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg></span>
                                        </div>
                                        <input type="tel" placeholder="Số nước" class="form-control" value="3.500.000" data-type="currency">
                                    </div>
                                </div>
                            </div>*@

                            <div class="col-12">
                                <div class="col-form-label">
                                    <span class="tx-uppercase tx-medium tx-spacing-1 d-inline-block">
                                        Dịch vụ
                                        phòng
                                    </span>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12">
                                        <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-b-5 tx-color-03">Lựa chọn Tiện ích cho phòng<span class="text-danger">(*)</span></label>
                                        <div class="table__filter-wrap">
                                            <div class="">
                                                <table class="table table-hover table-striped">
                                                    <thead class="">
                                                        <tr class="tr-header-table">
                                                            <th class="sort-label" data-column="col-electronic">Tên tiện ích</th>
                                                            <th class="sort-label " data-column="col-service">Giá tiền tiện ích</th>
                                                            <th class="sort-label " data-column="col-service">Lựa chọn</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="tbody-update-room-utilities">
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                               
                            </div>
                        </div>
                    </div>


                </div><!-- modal-body -->
                <div class="modal-footer pd-x-20 pd-y-15">
                    <button type="button" class="btn btn-white" data-dismiss="modal">Huỷ</button>
                    <button type="button" class="btn btn-primary edit-room-service">Lưu lại</button>
                </div>
            </div><!-- modal-content -->
        </div><!-- modal-dialog -->
    </div>
    <!--Modal edit tien ich-->


    <div class="container pd-x-0 pd-lg-x-10 pd-xl-x-0">
        <div class="row row-xs">
            <div class="col">
                <div class="table__filter__wrap bd-t pd-t-15">
                    <div class="table__filter-header mg-t-0-f">
                        <div class="table__header-left d-flex">
                            <div class="search__box control">
                                <input type="text" name="search" class="form-control search__box-area input-style" placeholder="Tìm kiếm...">
                                <a id="btn-search" href="javascript:;" class="search__box-icon "><i class="fa fa-search" aria-hidden="true"></i></a>
                            </div>
                        </div>
                        <div class="table__header-right">
                            <div class="header__right-action">
                                @*<div class="select-sort">
                                    <span>Sắp trống: </span>
                                    <select name="" class="form-control">
                                        <option value="">Tháng sau</option>
                                        <option value="">2 tháng tới</option>
                                        <option value="">3 tháng tới</option>
                                        <option value="">4 tháng tới</option>
                                        <option value="">5 tháng tới</option>
                                    </select>
                                </div>*@
                                <div class="select-sort">
                                    <span>Sắp xếp: </span>
                                    <select name="" class="form-control" onchange="sort_data_name(this.value)">
                                        <option value="0">Tên trọ A-Z ↓</option>
                                        <option value="1">Tên trọ Z-A ↑</option>

                                        <option value="">Tiền nợ ↓</option>
                                        <option value="">Tiền nợ ↑</option>
                                    </select>
                                </div>
                                <div class="select-sort">
                                    <span>Trạng thái: </span>
                                    <select name="" class="form-control">
                                        <option value="">Sắp chuyển vào</option>
                                        <option value="">Phòng trống</option>
                                        <option value="">Sắp dọn ra</option>
                                        <option value="">Chưa có khách dọn vào</option>
                                        <option value="">Đã thu tiền</option>
                                        <option value="">Chưa thu tiền</option>
                                    </select>
                                </div>
                                <div class="mg-b-15">
                                    <a href="#" class="btn btn-style control js-toggle-filter" id="js-toggle-filter"><i class="fa fa-filter" aria-hidden="true"></i></a>
                                    @*<a href="#" class="btn btn-style js-customize-column m-0" data-target="table-list-room"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sliders"><line x1="4" y1="21" x2="4" y2="14"></line><line x1="4" y1="10" x2="4" y2="3"></line><line x1="12" y1="21" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="3"></line><line x1="20" y1="21" x2="20" y2="16"></line><line x1="20" y1="12" x2="20" y2="3"></line><line x1="1" y1="14" x2="7" y2="14"></line><line x1="9" y1="8" x2="15" y2="8"></line><line x1="17" y1="16" x2="23" y2="16"></line></svg></a>*@
                                </div>


                            </div>
                        </div>
                    </div>
                    <div class="table__filter-form">
                        <div class="filter__form__wrap">
                            <div class="filter__form-col">
                                <div class="form__group">
                                    <label>Trạng thái phòng</label>
                                    <select name="" class="form-control" onchange="sort_data_status(this.value)">
                                        <option value="" selected="">-Tất cả-</option>
                                        <option value="0">Phòng trống</option>
                                        <option value="1">Sắp chuyển vào</option>
                                        <option value="2">Đang ở</option>
                                        <option value="3">Sắp dọn ra</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter__form-col">
                                <div class="form__group">
                                    <label>Điện nước</label>
                                    <select name="" class="form-control">
                                        <option value="">-Tất cả-</option>
                                        <option value="1" selected="">Chưa ghi</option>
                                        <option value="1" selected="">Đã ghi</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter__form-col">
                                <div class="form__group">
                                    <label>Phòng sắp trống</label>
                                    <div class="row from-to-group">
                                        <div class="col-6">
                                            <input type="text" class="form-control datetimepicker date-only from-date" placeholder="Từ ngày" autocomplete="off">
                                        </div>
                                        <div class="col-6">
                                            <input type="text" class="form-control datetimepicker date-only to-date" placeholder="Đến ngày" autocomplete="off">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="filter__form-col">
                                <div class="form__group">
                                    <label>Ngày dọn vào</label>
                                    <div class="row from-to-group">
                                        <div class="col-6">
                                            <input type="text" class="form-control datetimepicker date-only from-date" placeholder="Từ ngày" autocomplete="off">
                                        </div>
                                        <div class="col-6">
                                            <input type="text" class="form-control datetimepicker date-only to-date" placeholder="Đến ngày" autocomplete="off">
                                        </div>
                                    </div>

                                </div>
                            </div>


                            <div class="filter__form-col">
                                <div class="form__group">
                                    <label>Nhà / dãy trọ</label>
                                    <select id="branch-search" name="branch-search" class="form-control" onchange="sort_data_Branch(this.value)">
                                        <option value="">-Tất cả-</option>
                                        
                                    </select>
                                </div>
                            </div>
                            <div class="filter__form-col">
                                <div class="form__group">
                                    <label>Thu tiền</label>
                                    <select name="" class="form-control">
                                        <option value="">-Tất cả-</option>
                                        <option value="1" selected="">Chưa thu tiền</option>
                                        <option value="2" selected="">Đã thu tiền</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter__form-col">
                                <div class="form__group">
                                    <label>Loại phòng</label>
                                    <select id="ListRoomType-sort" name="" class="form-control" onchange="sort_data_room_type(this.value)">
                                        <option value="">-Tất cả-</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter__form-col">
                                <div class="form__group">
                                    <label>Tiền nợ</label>
                                    <select name="" class="form-control">
                                        <option value="">-Tất cả-</option>
                                        <option value="1" selected="">Đang có nợ</option>
                                        <option value="2" selected="">Không nợ</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="filter__form-submit">
                            <a href="javascript:;" class="btn btn-warning" id="js-filter-submit">Tìm nâng cao</a>
                        </div>
                    </div>
                    <div class="table__filter-wrap">
                        <div class="table-responsive">
                            <table class="table table-hover table-striped  border" id="table-list-room">
                                <thead>
                                    <tr class="tr-header-table">
                                        <th class="checkbox-col">
                                        </th>
                                        <th class="sort-label" data-column="col-house">Nhà / dãy trọ</th>
                                        <th class="sort-label" data-column="col-room">Tên phòng</th>
                                        <th class="sort-label" data-column="col-money">Giá tiền</th>
                                        <th class="sort-label" data-column="col-type">
                                            Loại
                                        </th>
                                        <th class="sort-label" data-column="col-status">Trạng thái</th>
                                        <th class="sort-label" data-column="col-electric">Thu tiền</th>
                                        <th class="sort-label" data-column="col-people">Điện / nước</th>
                                        <th class="sort-label" data-column="col-deposit">Tiền nợ</th>
                                        <th class="action-col"></th>
                                    </tr>
                                </thead>
                                <tbody class="tbody-roomlist" id="tbody-roomlist">
                                </tbody>

                            </table>
                        </div>
                        <nav aria-label="Page navigation text-right">
                            <ul class="pagination mg-b-0">
                                @await Html.PartialAsync("_PaginationPartial")
                                <li class="page-item disabled"><a class="page-link page-link-icon" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-left"><polyline points="15 18 9 12 15 6"></polyline></svg></a></li>
                                <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                <li class="page-item"><a class="page-link" href="#">2</a></li>
                                <li class="page-item"><a class="page-link" href="#">3</a></li>
                                <li class="page-item"><a class="page-link page-link-icon" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline></svg></a></li>
                            </ul>
                        </nav>
                    </div>
                </div>

            </div>
        </div><!-- row -->
    </div><!-- container -->
</div>
<script>
        // upload img
        $('.btn-uploads').on('click', function () {
            $('.upload-image-temps').click();
        });
    $('.btn-uploads-edit').on('click', function () {
        $('.upload-image-temps-edit').click();
    });
        //
        // xóa img
        let listImage = [];
        function deleteImage(index) {

            //list.remove(index);
            listImage.splice(index,1);
        }
        //
        $(document).ready(function () {
            // chọn tòa nhà call api tòa nhà
            load_branch();
            load_roomtype();
        });
        // on change
        $('#ListBranch').on('change', function () {
            let branchId = $('#ListBranch').val();
            select = document.getElementById('ListFloor');
            var length = select.options.length;
            for (i = length - 1; i >= 0; i--) {
                select.options[i] = null;
            }
            var opt = document.createElement('option');
            opt.innerHTML = 'Chọn tầng';
            select.appendChild(opt);
            opt.setAttribute("disabled", "true");
            opt.setAttribute("selected","selected");

             $.ajax({
                type: 'GET',
                dataType: "json",
                 url: '@Model.Domain' + 'api/Floor/get-by-branch/' + branchId,
                headers: {
                    'Authorization': 'Bearer ' + '@Model.Token',
                    'Content-Type': 'application/json'
                },
                success: function (data, status, xhr) {
                    let list = data.Data.Items;

                    for (let i = 0; i < list.length; i++) {
                        var opti = document.createElement('option');
                        opti.value = list[i].Id;
                        opti.innerHTML = list[i].Name;
                        select.appendChild(opti);
                    }
                },
                error: function (xhr, status, error) {
                    alert("Result: " + status + " " + error + " " + xhr.status + " " + xhr.statusText)
                }
            });

        });

        $('#ListBranch-edit').on('change', function () {
            let branchId = $('#ListBranch-edit').val();
            select = document.getElementById('ListFloor-edit');
            var length = select.options.length;
            for (i = length - 1; i >= 0; i--) {
                select.options[i] = null;
            }
            var opt = document.createElement('option');
            opt.innerHTML = 'Chọn tầng';
            select.appendChild(opt);
            opt.setAttribute("disabled", "true");
            opt.setAttribute("selected","selected");

             $.ajax({
                type: 'GET',
                dataType: "json",
                 url: '@Model.Domain' + 'api/Floor/get-by-branch/' + branchId,
                headers: {
                    'Authorization': 'Bearer ' + '@Model.Token',
                    'Content-Type': 'application/json'
                },
                success: function (data, status, xhr) {
                    let list = data.Data.Items;

                    for (let i = 0; i < list.length; i++) {
                        var opti = document.createElement('option');
                        opti.value = list[i].Id;
                        opti.innerHTML = list[i].Name;
                        select.appendChild(opti);
                    }
                },
                error: function (xhr, status, error) {
                    alert("Result: " + status + " " + error + " " + xhr.status + " " + xhr.statusText)
                }
            });

        });
    //on click
    $('.btn-save-image-edit').on('click', function () {
        let StringAddImageLinks = '';
        let StringdeleteImageId = '';
        // lay du lieu anh moi' load
        console.log('them moi anh'+listImage);
        // lay' danh sach anh muon' xoa'
        console.log('xoa anh'+listImageToDelete);
        // upload anh moi' va luu roomImage
        if (listImage.length > 0) {
            let ImageNames = upload_img(listImage);
                for (let i = 0; i < ImageNames.length; i++) {
                    ImageNames[i] = '@Model.Domain' + ImageNames[i];
                }
            StringAddImageLinks = ImageNames.join(';');
        }
        // danh sach anh bi xoa' chuyen doi sang Chuoi String
        if (listImageToDelete.length > 0) {
            StringdeleteImageId = listImageToDelete.join(';');
        }
        if (ckstring(StringAddImageLinks) && ckstring(StringdeleteImageId)) {
            Swal.fire(
                'Cảnh báo',
                'hình ảnh không thay đổi!',
                'warning'
            )
        }
        else {
            let data = {};
            data['roomId'] = $('#hdfId-update-room-image').val();
            data['stringAddImageLinks'] = StringAddImageLinks;
            data['stringdeleteImageId'] = StringdeleteImageId;
            console.log(data.roomId, data.StringAddImageLinks, data.StringdeleteImageId);
            update_image_room(data);
        }
    });
    // function updata anh
    function update_image_room(data) {
        $('.btn-save-image-edit').prop('disabled', true);
        let type_request = 'POST';
            $.ajax({
                url: '@Model.Domain' + 'api/RoomImage/UpdateImageRoom',
                data: JSON.stringify(data),
                type: type_request,
                dataType: 'JSON',
                headers: {
                    'Authorization': 'Bearer ' + '@Model.Token',
                    'Content-Type': 'application/json'
                },
                contentType: "application/json",
                success: function (data) {
                        Swal.fire(
                            'Thông báo!',
                            'Cập nhật dữ liệu thành công!',
                            'success'
                        );
                    $('.btn-save-image-edit').prop('disabled', false);
                    location.reload();
                },
                error: function (xhr, status, error) {
                    Swal.fire(
                        'Thông báo!',
                        'Rất tiếc đã xảy ra lỗi!',
                        'error'
                    );
                    $('.btn-save-image-edit').prop('disabled', false);
                    console.log("Result Insert: " + status + " " + error + " " + xhr.status + " " + xhr.statusText)
                }
            });
    }


        $('.btn-save-room').on('click', function () {
            // lấy giữ liệu từ form
            let id = 0;
            let name = $('input[name=txt-room-name]').val();
            let branchId = $('#ListBranch').val();
            let branchFloor = $('#ListFloor').val();
            let price = $('input[name=txt-room-price]').val().replaceAll(',', '');
            let acreage = $('input[name=txt-Acreage]').val();
            let deposit = $('input[name=txt-deposit]').val().replaceAll(',', '');
            let bedamount = $('input[name=txt-BedAmount]').val();
            let roomTypeId = $('#ListRoomType').val();
            let status = $('#room-status').val();
            // danh sách img (mảng Link image)
            if (ckstring(name) || ckstring(branchId) || ckstring(branchFloor) || ckstring(price) || ckstring(acreage) || ckstring(deposit) || ckstring(bedamount) || listImage.length == 0 || ckstring(roomTypeId) || ckstring(status)) {
                Swal.fire(
                    'Cảnh báo',
                    'Vui lòng nhập đầy đủ thông tin!',
                    'warning'
                )
            }
            else {
                let ImageNames = upload_img(listImage);
                for (let i = 0; i < ImageNames.length; i++) {
                    ImageNames[i] = '@Model.Domain' + ImageNames[i];
                }
                let StringImageNames = ImageNames.join(';');
                $(this).prop('disabled', true);
                Insert(id, name, branchId, branchFloor, price, acreage, deposit, bedamount, StringImageNames, roomTypeId, status);

            }

        });
        // save edit
        $('.btn-save-room-edit').on('click', function () {
            // lấy giữ liệu từ form
            let id = $('#hdfId').val();
            let name = $('input[name=txt-room-name-edit]').val();
            let branchId = $('#ListBranch-edit').val();
            let branchFloor = $('#ListFloor-edit').val();
            let price = $('input[name=txt-room-price-edit]').val().replaceAll(',', '');
            let acreage = $('input[name=txt-Acreage-edit]').val();
            let deposit = $('input[name=txt-deposit-edit]').val().replaceAll(',', '');
            let bedamount = $('input[name=txt-BedAmount-edit]').val();
            let roomTypeId = $('#ListRoomType-edit').val();
            let status = $('#room-status-edit').val();


            if (ckstring(name) || ckstring(branchId) || ckstring(branchFloor) || ckstring(price) || ckstring(acreage) || ckstring(deposit) || ckstring(bedamount) || ckstring(roomTypeId) || ckstring(status)) {
                Swal.fire(
                    'Cảnh báo',
                    'Vui lòng nhập đầy đủ thông tin!',
                    'warning'
                )
            }
            else {
                $(this).prop('disabled', true);
                Update(id, name, branchId, branchFloor, price, acreage, deposit, bedamount, roomTypeId, status);
            }
        });
        //update
        function Update(id, name, branchId, branchFloor, price, acreage, deposit, bedamount, roomTypeId, status) {
            let data = {};
            data["id"] = id;
            data["deleted"] = false;
            data["active"] = false;
            data["name"] = name;
            data["branchId"] = branchId;
            data["branchFloor"] = branchFloor;
            data["price"] = price;
            data["acreage"] = acreage;
            data["deposit"] = deposit;
            data["status"] = status; // status 0: phòng trống, 1: sắp chuyển vào, 2: đang thuê, 3: sắp dọn ra
            data["bedAmount"] = bedamount;
            data["roomTypeId"] = roomTypeId;

            let type_request = 'PUT';

            $('#modal-room').modal('hide');
            $.ajax({
                url: '@Model.Domain' + 'api/Room',
                data: JSON.stringify(data),
                type: type_request,
                dataType: 'JSON',
                headers: {
                    'Authorization': 'Bearer ' + '@Model.Token',
                    'Content-Type': 'application/json'
                },
                contentType: "application/json",
                success: function (data) {
                        Swal.fire(
                            'Thông báo!',
                            'Cập nhật dữ liệu thành công!',
                            'success'
                        );
                    $('.btn-save-room-edit').prop('disabled', false);
                    load_Room(PageIndex, PageSize, SearchContent, OrderBy, Status, RoomType, BranchId);
                },
                error: function (xhr, status, error) {
                    Swal.fire(
                        'Thông báo!',
                        'Rất tiếc đã xảy ra lỗi!',
                        'error'
                    );
                    $('.btn-save-room-edit').prop('disabled', false);
                    console.log("Result Insert: " + status + " " + error + " " + xhr.status + " " + xhr.statusText)
                }
            });
        }

        // insert
        function Insert(id, name, branchId, branchFloor, price, acreage, deposit, bedamount, StringImageNames, roomTypeId, status) {
            let data = {};
            data["id"] = id;
            data["deleted"] = false;
            data["active"] = false;
            data["name"] = name;
            data["branchId"] = branchId;
            data["branchFloor"] = branchFloor;
            data["floorId"] = branchFloor;
            data["price"] = price;
            data["acreage"] = acreage;
            data["deposit"] = deposit;
            data["status"] = status; // status 0: phòng trống, 1: sắp chuyển vào, 2: đang thuê, 3: sắp dọn ra
            data["bedAmount"] = bedamount;
            data["roomTypeId"] = roomTypeId;
            data["images"] = StringImageNames;
            let type_request = 'POST';

            $('#modal-room').modal('hide');
            $.ajax({
                url: '@Model.Domain' + 'api/Room/AddNewRoom',
                data: JSON.stringify(data),
                type: type_request,
                dataType: 'JSON',
                headers: {
                    'Authorization': 'Bearer ' + '@Model.Token',
                    'Content-Type': 'application/json'
                },
                contentType: "application/json",
                success: function (data) {
                        Swal.fire(
                            'Thông báo!',
                            'Thêm dữ liệu thành công!',
                            'success'
                        );
                    $('.btn-save-room').prop('disabled', false);
                    load_Room(PageIndex, PageSize, SearchContent, OrderBy, Status, RoomType, BranchId);
                },
                error: function (xhr, status, error) {
                    Swal.fire(
                        'Thông báo!',
                        'Rất tiếc đã xảy ra lỗi!',
                        'error'
                    );
                    $('.btn-save-room').prop('disabled', false);
                    console.log("Result Insert: " + status + " " + error + " " + xhr.status + " " + xhr.statusText)
                }
            });
    }
    // lấy thông tin và hiển thị hình ảnh
    function readURL(input, inputId, loadId) {
        console.log(inputId, loadId);
            if (input.files && input.files[0]) {
                listImage = [];
                let html = '';
                for (let i = 0; i < input.files.length; i++) {
                    //html += '<img id="room-img-' + i + '" src="#" alt="your image" width="150" height="200" />';
                    html += `<div class="image-wrap">
                            <div class="image-box lightgallery">
                                <a id="room-img-href-` + i + `" href="#" class=""> <img id="room-img-` + i + `" style=" margin-left: 20px; margin-right: 20px;" width="150" height="200" src="#" alt="image" class="img "></a>
                            </div>
                            <a id="img-` + i + `" onClick="deleteImage(`+i+`)" href="javascript:;" class="delete-image"><i class="fas fa-times"></i></a>
                        </div>`;
                }
                $('#' + loadId).hide().html(html).show('slow');
                for(let i = 0; i < input.files.length; i++) {
                    var reader = new FileReader();
                    reader.onload = function (e) {
                        $('#' + 'room-img-' + i)
                            .attr('src', e.target.result)
                            .width(150)
                            .height(200);
                        $('#' + 'room-img-href-' + i)
                            .attr('href', e.target.result)
                    };
                    reader.readAsDataURL(input.files[i]);
                }
                let value = document.getElementById(inputId).files;
                for (let i of value) {
                    listImage.push(i);
                }
            }

        }

        function upload_img(files) {
            let rs = [];
            var formData = new FormData();
            for (let i = 0; i < files.length; i++) {
                formData.append('files', files[i]);
            }
            $.ajax({
                async: false,
                type: 'POST',
                url: '@Model.Domain' + 'api/file/upload-multiple-files',
                headers: {
                    'Authorization': 'Bearer ' + '@Model.Token',
                },
                data: formData,
                dataType: 'json',
                contentType: false,
                processData: false,
                success: function (data, status, xhr) {
                    console.log("upload thanh cong");
                    console.log(data);
                    rs = data.Data;
                },
                error: function (xhr, status, error) {
                    alert("Result: " + status + " " + error + " " + xhr.status + " " + xhr.statusText)
                }
            });
            return rs;
        }

        function load_branch()
        {
            $.ajax({
                type: 'GET',
                dataType: "json",
                url: '@Model.Domain' + 'api/Branch?PageIndex=1&PageSize=20&OrderBy=0&TenantId=' + '@Model.Users.Id',
                headers: {
                    'Authorization': 'Bearer ' + '@Model.Token',
                    'Content-Type': 'application/json'
                },
                success: function (data, status, xhr) {
                    let list = data.Data.Items;
                    select = document.getElementById('ListBranch');

                    for (let i = 0; i < list.length; i++) {
                        var opt = document.createElement('option');
                        opt.value = list[i].Id;
                        opt.innerHTML = list[i].Name;
                        select.appendChild(opt);
                    }
                    select2 = document.getElementById('ListBranch-edit');
                    for (let i = 0; i < list.length; i++) {
                        var opt = document.createElement('option');
                        opt.value = list[i].Id;
                        opt.innerHTML = list[i].Name;
                        select2.appendChild(opt);
                    }
                    select3 = document.getElementById('branch-search');
                    for (let i = 0; i < list.length; i++) {
                        var opt = document.createElement('option');
                        opt.value = list[i].Id;
                        opt.innerHTML = list[i].Name;
                        select3.appendChild(opt);
                    }
                    select4 = document.getElementById('branch-search-main');
                    for (let i = 0; i < list.length; i++) {
                        var opt = document.createElement('option');
                        opt.value = list[i].Id;
                        opt.innerHTML = list[i].Name;
                        select4.appendChild(opt);
                    }
                },
                error: function (xhr, status, error) {
                    alert("Result: " + status + " " + error + " " + xhr.status + " " + xhr.statusText)
                }
            });
        }
        function load_roomtype() {
            $.ajax({
                type: 'GET',
                dataType: "json",
                url: '@Model.Domain' + 'api/RoomType?PageIndex=1&PageSize=20&OrderBy=0&TenantId=' + '@Model.Users.Id',
                headers: {
                    'Authorization': 'Bearer ' + '@Model.Token',
                    'Content-Type': 'application/json'
                },
                success: function (data, status, xhr) {
                    let list = data.Data.Items;

                    select = document.getElementById('ListRoomType');
                    for (let i = 0; i < list.length; i++) {
                        let obj = { id : list[i].Id ,name : list[i].Name };
                        var opt = document.createElement('option');
                        opt.value = list[i].Id;
                        opt.innerHTML = list[i].Name;
                        select.appendChild(opt);
                    }
                    select2 = document.getElementById('ListRoomType-edit');
                    for (let i = 0; i < list.length; i++) {
                        var opt = document.createElement('option');
                        opt.value = list[i].Id;
                        opt.innerHTML = list[i].Name;
                        select2.appendChild(opt);
                    }
                    select3 = document.getElementById('ListRoomType-sort');
                    for (let i = 0; i < list.length; i++) {
                        var opt = document.createElement('option');
                        opt.value = list[i].Id;
                        opt.innerHTML = list[i].Name;
                        select3.appendChild(opt);
                    }
                },
                error: function (xhr, status, error) {
                    alert("Result: " + status + " " + error + " " + xhr.status + " " + xhr.statusText)
                }
            });
        }
        $('.btn-add-room').on('click', function () {

            $('#modal-room').modal('show');
        });
</script>
<!--by baonguyen-->
<!--Call API danh sách phòng phòng-->
<script>
        let PageIndex = 1;
        let PageSize = 20;
        let OrderBy = 0;
        let SearchContent = '';
        let TotalItem = 0;
        let TotalPage = 0;
        let Status = -1;
        let RoomType = -1;
        let BranchId = -1;
        $(document).ready(function () {
            load_Room(PageIndex, PageSize, SearchContent, OrderBy, Status, RoomType, BranchId);
        });
        function load_Room(_PageIndex, _PageSize, _SearchContent, _OrderBy, _Status, _RoomType, _BranchId) {
            $.ajax({
                type: 'GET',
                dataType: "json",
                url: '@Model.Domain' + 'api/Room?PageIndex=' + _PageIndex + '&PageSize=' + _PageSize + '&status=' + _Status + '&roomtypeid=' + _RoomType + '&SearchContent=' + _SearchContent + '&OrderBy=' + _OrderBy + '&BranchId=' + _BranchId+'&TenantId=' + '@Model.Users.Id',
                headers: {
                    'Authorization': 'Bearer ' + '@Model.Token',
                    'Content-Type': 'application/json'
                },
                success: function (data, status, xhr) {
                    let list = data.Data.Items;
                    let html = '';
                    // Create our number formatter.
                    var formatter = new Intl.NumberFormat('en-US', {
                        style: 'currency',
                        currency: 'VND',

                        // These options are needed to round to whole numbers if that's what you want.
                        //minimumFractionDigits: 0, // (this suffices for whole numbers, but will print 2500.10 as $2,500.1)
                        //maximumFractionDigits: 0, // (causes 2500.99 to be printed as $2,501)
                    });

                    for (let i = 0; i < list.length; i++) {
                        let item = list[i];
                        // xử lý dữ liệu và trang thái phòng
                        let status = "";
                        let CssClass=""
                        if (item.Status == 0) {
                            CssClass="badge badge-light wd-100 pd-5 tx-12";
                            status = "Phòng trống";
                        } if (item.Status == 1) {
                            CssClass="badge badge-warning wd-100 pd-5 tx-12";
                            status = "Sắp chuyển vào";
                        }if (item.Status == 2) {
                            CssClass="badge badge-primary wd-100 pd-5 tx-12";
                            status = "Đang thuê";
                        } if (item.Status == 3) {
                            CssClass="badge badge-danger wd-100 pd-5 tx-12";
                            status = "Sắp dọn ra";
                        }
                        //
                        html += `<tr>
                                        <td class="checkbox-col">
                                            <a href="javascript:;" class="toggle-collapse"><i class="fa fa-angle-down"></i></a>
                                        </td>
                                        <td data-column="col-house">
                                            <a href="./RoomDetail/`+ item.Id +`">
                                                `+ item.BranchName +`
                                            </a>
                                        </td>
                                        <td data-column="col-room">
                                            <a href="./RoomDetail/`+ item.Id +`">`+ item.Name +`</a>
                                        </td>
                                        <td data-column="col-money">
                                            <p class="mg-b-0 tx-medium">`+ formatter.format(item.Price) +`/Tháng</p>
                                        </td>
                                        <td data-column="col-type">
                                            <div >
                                                <label ><span>`+ item.RoomTypeName+`</span></label>
                                            </div>
                                        </td>
                                        <td data-column="col-status">
                                            <span class="`+ CssClass +`" name="status">
                                                `+ status +`
                                            </span>
                                            <p class="mg-b-0 mg-t-5 tx-12">Dọn vào: 20/04/2020</p>
                                        </td>
                                        <td data-column="col-electric">---</td>
                                        <td data-column="col-people">---</td>
                                        <td data-column="col-deposit">
                                            <span class="tx-danger tx-medium">12.000.000</span>
                                        </td>
                                        <td class="action-col">
                                            <div class="dropdown__wrap">
                                                <a href="#" class="table-action"><i class="fa fa-ellipsis-v" aria-hidden="true"></i></a>
                                                <ul class="drop-menu">
                                                    <li class="drop-menu-item"><a href="./RoomDetail/`+item.Id+`" class="item-link"><span class="icon"><i class="fas fa-info-circle" aria-hidden="true"></i></span>Chi tiết</a></li>
                                                    <li class="drop-menu-item">
                                                        <a href="#js-electronicNote" data-toggle="modal" class="item-link" onclick="electricRecord(`+ item.Id +`)">
                                                            <span class="icon"><i class="fas fa-calendar-alt" aria-hidden="true"></i></span>Ghi
                                                            điện
                                                        </a>
                                                    </li>
                                                    <li class="drop-menu-item">
                                                        <a href="#js-ImageNote" data-toggle="modal" class="item-link" onclick="DetailImage(`+ item.Id +`)">
                                                            <span class="icon"><i class="fas fa-image" aria-hidden="true" ></i></span>Hình ảnh
                                                        </a>
                                                    </li>
                                                    <li class="drop-menu-item">
                                                        <a href="#js-ImageNote" data-toggle="modal" class="item-link" onclick="EditRoom(`+ item.Id +`)">
                                                            <span class="icon"><i class="fas fa-edit" aria-hidden="true"></i></span>Chỉnh sửa
                                                        </a>
                                                    </li>
                                                    <li class="drop-menu-item">
                                                        <a href="javascript:;" data-toggle="modal" class="item-link" onclick="takeMoney(`+ item.Id +`)">
                                                            <span class="icon"><i class="fas fa-hand-holding-usd" aria-hidden="true" ></i></span>Tính tiền
                                                        </a>
                                                    </li>
                                                    <li class="drop-menu-item">
                                                        <a href="#js-payMoney" data-toggle="modal" class="item-link" onclick="takeMoney(`+ item.Id +`)">
                                                            <span class="icon"><i class="fas fa-hand-holding-usd" aria-hidden="true" ></i></span>Thu
                                                            tiền
                                                        </a>
                                                    </li>
                                                    <li class="drop-menu-item">
                                                        <a href="#js-goOut" data-toggle="modal" class="item-link">
                                                            <span class="icon"><i class="fas fa-sign-out-alt" aria-hidden="true" onclick="moveOut(`+ item.Id +`)"></i></span>Dọn
                                                            ra
                                                        </a>
                                                    </li>
                                                    <li class="drop-menu-item">
                                                        <a href="/Room/AddCustomer/`+item.Id+`" class="item-link">
                                                            <span class="icon"><i class="fas fa-sign-in-alt" aria-hidden="true"></i></span>Dọn
                                                            vào
                                                        </a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </td>
                                    </tr>

                                    <tr class="collapse-row">
                                        <td colspan="12">
                                            <div class="table-content">
                                                <div class="row flex-wrap-1 mg-t-15">
                                                    <div class="col-sm-12 col-md-4 mg-b-30 mg-md-b-0">
                                                        <div class="room-infor legend-box pd-25  rounded " data-label="Thông tin phòng">
                                                            <a href="#js-edit-cus" onclick="EditRoom(`+ item.Id +`)" data-toggle="modal" class="edit-cus-info edit-field"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34"></path><polygon points="18 2 22 6 12 16 8 16 8 12 18 2"></polygon></svg></a>
                                                            <div class="info-list">
                                                                <dl class="row-info">
                                                                    <dd class="">Tên phòng:</dd>
                                                                    <dt class="">`+ item.Name +`</dt>
                                                                </dl>
                                                                <dl class="row-info hide-on-print">
                                                                    <dd class="">Trạng thái:</dd>
                                                                    <dt class="">
                                                                        <span tabindex="0" class="badge badge-warning valign-middle" role="button" data-toggle="popover" data-trigger="hover" title="" data-content="Đặt cọc: 30.000.000 - Ngày chuyển vào: 30/03/2020" data-original-title="Trương Văn Lam ">
                                                                            Đã đặt cọc
                                                                        </span>
                                                                    </dt>
                                                                </dl>


                                                                <dl class="row-info">
                                                                    <dd class="">Người đại diện:</dd>
                                                                    <dt class="">`+item.FullName+`</dt>
                                                                </dl>
                                                                <dl class="row-info">
                                                                    <dd class="">Điện thoại:</dd>
                                                                    <dt class="">`+ item.Phone +`</dt>
                                                                </dl>
                                                                <dl class="row-info">
                                                                    <dd class="">Ngày dọn vào:</dd>
                                                                    <dt class="">20/11/2020</dt>
                                                                </dl>
                                                                <dl class="row-info mg-b-0">
                                                                    <dd class="">Tiền nợ:</dd>
                                                                    <dt class=""><span class="tx-danger">3.500.000</span></dt>
                                                                </dl>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-12 col-md-8 ">
                                                        <div class="legend-box pd-25  " data-label="Phí và dịch vụ">
                                                            <a href="#js-edit-service" onclick="EditServiceRoom(`+item.Id+`)" data-toggle="modal" class="edit-service-info edit-field"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34"></path><polygon points="18 2 22 6 12 16 8 16 8 12 18 2"></polygon></svg></a>
                                                            <div class="row">
                                                                <div class="col-sm-6">
                                                                    <div class="info-list">
                                                                        <dl class="row-info">
                                                                            <dd class="">Giá phòng:</dd>
                                                                            <dt class="">`+ format_money(item.Price) +`</dt>
                                                                        </dl>
                                                                        <dl class="row-info">
                                                                            <dd class="">Giá điện / KW:</dd>
                                                                            <dt class="">`+ format_money(item.ElectricPrice) +`</dt>
                                                                        </dl>
                                                                        <dl class="row-info">
                                                                            <dd class="">Giá nước:</dd>
                                                                            <dt class="">`+ format_money(item.WaterPrice) +`</dt>
                                                                        </dl>
                                                                        <dl class="row-info">
                                                                            <dd class="">Điện tháng trước:</dd>
                                                                            <dt class="">
                                                                                <span class="mg-r-10" tabindex="0" role="button" data-toggle="popover" data-trigger="hover" title="" data-content="<strong>32323244</strong> <br/> Đã dùng: <strong>150 kW</strong>" data-original-title="Số điện tháng 3">500.000</span>
                                                                                <span class="tx-normal"><a href="#js-electronicPicture" data-toggle="modal">Ảnh</a></span>
                                                                            </dt>
                                                                        </dl>
                                                                        <dl class="row-info">
                                                                            <dd class="">Nước tháng trước:</dd>
                                                                            <dt class="">
                                                                                <span tabindex="0" class="mg-r-10" role="button" data-toggle="popover" data-trigger="hover" title="" data-content="<strong>32323244</strong> <br/> Đã dùng: <strong>150 m<sup>3</sup></strong>" data-original-title="Số nước tháng 3">500.000</span>
                                                                                <span class="tx-normal"><a href="#js-waterPicture" data-toggle="modal">Ảnh</a></span>
                                                                            </dt>
                                                                        </dl>

                                                                    </div>
                                                                </div>
                                                                <div class="col-sm-6">
                                                                    <div class="info-list-`+ item.Id +`">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>


                                                    </div>

                                                </div>
                                                <div class="table-responsive">
                                                    <table class="table  valign-center tx-nowrap table-striped tx-center">
                                                        <caption class="tx-left-f mg-b-0-f">Lịch sử thanh toán</caption>
                                                        <thead class="valign-middle">
                                                            <tr>
                                                                <th>Tháng</th>
                                                                <th>Tiền nhà</th>
                                                                <th><span class="">Điện<span></span></span></th>
                                                                <th><span class="">Nước</span></th>
                                                                <th><span class="">Dịch vụ</span></th>
                                                                <th><span class="">Tổng</span></th>
                                                                <th><span class="">Thực nhận</span></th>
                                                                <th><span class="">Còn nợ</span></th>

                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td>Tháng 06/2020</td>
                                                                <td>3.000.000</td>
                                                                <td>500.000</td>
                                                                <td>226.00</td>
                                                                <td>300.000</td>
                                                                <td>4.126.000</td>
                                                                <td>3.500.000</td>
                                                                <td><span class="tx-danger">620.000</span></td>

                                                            </tr>
                                                            <tr>
                                                                <td>Tháng 06/2020</td>
                                                                <td>3.000.000</td>
                                                                <td>500.000</td>
                                                                <td>226.00</td>
                                                                <td>300.000</td>
                                                                <td>4.126.000</td>
                                                                <td>3.500.000</td>
                                                                <td><span class="tx-danger">620.000</span></td>

                                                            </tr>
                                                            <tr>
                                                                <td>Tháng 06/2020</td>
                                                                <td>3.000.000</td>
                                                                <td>500.000</td>
                                                                <td>226.00</td>
                                                                <td>300.000</td>
                                                                <td>4.126.000</td>
                                                                <td>3.500.000</td>
                                                                <td><span class="tx-danger">620.000</span></td>

                                                            </tr>
                                                            <tr>
                                                                <td>Tháng 06/2020</td>
                                                                <td>3.000.000</td>
                                                                <td>500.000</td>
                                                                <td>226.00</td>
                                                                <td>300.000</td>
                                                                <td>4.126.000</td>
                                                                <td>3.500.000</td>
                                                                <td><span class="tx-danger">620.000</span></td>

                                                            </tr>
                                                        </tbody>
                                                    </table>

                                                </div>
                                            </div>
                                        </td>
                                    </tr>`;

                    }
                    $('#tbody-roomlist').hide().html(html).show('slow');
                    TotalItem = data.Data.TotalItem;
                    TotalPage = data.Data.TotalPage;
                    load_pagination(pagination(_PageIndex, TotalPage), _PageIndex, TotalPage, TotalItem);
                    // load xong phong thi load tien ich cua phong
                    for (let i = 0; i < list.length; i++) {
                        let item = list[i];
                        // xu ly danh sach tien ich
                        $(document).ready(function () {
                            let api_loadRoomUtilities = 'api/RoomUtilities?RoomId=' + item.Id + '&PageIndex=1&PageSize=20&OrderBy=0&TenantId=@Model.Users.Id';
                            load_data_with_jquery(api_loadRoomUtilities).then(function (e) {
                                let list = e.Data.Items;
                                let html = '';
                                for (let i = 0; i < list.length; i++) {
                                    let item = list[i];
                                    html += `<dl class="row-info">
                                                    <dd class="">`+ item.UtilitiName + `:</dd>
                                                    <dt class="">`+ format_money(item.Price) + `</dt>
                                                </dl>`;
                                }
                                $('.info-list-'+item.Id).html(html);
                            })


                        })
                        //
                    }
                },
                error: function (xhr, status, error) {
                    alert("Result: " + status + " " + error + " " + xhr.status + " " + xhr.statusText)
                }
            });
        }

    //nút tìm kiếm
    $('#btn-search').on('click', function () {
        SearchContent = $('input[name=search]').val();
        load_Room(PageIndex, PageSize, SearchContent, OrderBy, Status, RoomType, BranchId);
    });

    //Enter tìm kiếm
    $('input[name=search]').keyup(function (event) {
        if (event.keyCode === 13) {
            SearchContent = $('input[name=search]').val();
            load_Room(PageIndex, PageSize, SearchContent, OrderBy, Status, RoomType, BranchId);
        }
    });
    //Sắp xếp
    function sort_data_name(val) {
        OrderBy = val;
        load_Room(PageIndex, PageSize, SearchContent, OrderBy, Status, RoomType, BranchId);

    }
    function sort_data_status(val) {
        Status = val;
        load_Room(PageIndex, PageSize, SearchContent, OrderBy, Status, RoomType, BranchId);

    }
    function sort_data_room_type(val) {
        RoomType = val;
        load_Room(PageIndex, PageSize, SearchContent, OrderBy, Status, RoomType, BranchId);
    }
    function sort_data_Branch(val) {
        console.log(val);
        BranchId = val;
        load_Room(PageIndex, PageSize, SearchContent, OrderBy, Status, RoomType, BranchId);
    }
    //load phân trang
    $(function () {
        load_pagination(pagination(PageIndex, PageSize), PageIndex, TotalPage, TotalItem);
    });
    //load khi bấm chuyển trang
    function load_to_page(index_click) {
        PageIndex = index_click;
        //load lại data
        load_Room(PageIndex, PageSize, SearchContent, OrderBy, Status, RoomType, BranchId);
    }
</script>
<!--by baonguyen-->
<!--Call API Image Room Theo RoomID-->
<script>
    // cập nhật hình ảnh phòng
    let listImageToDelete = [];
    
    function DetailImage(RoomID) {
        listImageToDelete = [];
            $.ajax({
                type: 'GET',
                dataType: "json",
                url: '@Model.Domain' + 'api/RoomImage/GetImageRoomByRoomID?RoomId=' + RoomID,
                headers: {
                    'Authorization': 'Bearer ' + '@Model.Token',
                    'Content-Type': 'application/json'
                },
                success: function (data, status, xhr) {
                    $('#hdfId-update-room-image').val(RoomID);
                    let list = data.Data;
                    let html = '';
                    for (let i = 0; i < list.length; i++) {
                        let item = list[i];
                        let image = {};
                        image["id"] = item.Id;
                        image["link"] = item.Link;
                        html += `<div class="image-wrap">
                            <div class="image-box lightgallery">
                                <a href="`+ item.Link + `" class=""> <img style=" margin-left: 20px; margin-right: 20px;" width="150" height="200" src="` + item.Link +`" alt="image" class="img "></a>
                            </div>
                            <a href="javascript:;" class="delete-image" onClick="addImageIntoDelete(`+ item.Id +`)" ><i class="fas fa-times"></i></a>
                        </div>`;
                    }
                    let a = $('#image-byroomid').html(html);
                    $('#modal-room-image').modal('show');
                },
                error: function (xhr, status, error) {
                    alert("Result: " + status + " " + error + " " + xhr.status + " " + xhr.statusText)
                }
            });
        }

    function addImageIntoDelete(data) {
        listImageToDelete.push(data);
        console.log(listImageToDelete);
    }
//
        function EditRoom(RoomID) {
            $.ajax({
                type: 'GET',
                dataType: "json",
                url: '@Model.Domain' + 'api/Room/' + RoomID,
                headers: {
                    'Authorization': 'Bearer ' + '@Model.Token',
                    'Content-Type': 'application/json'
                },
                success: function (data, status, xhr) {
                    let item = data.Data;

                    // lấy giữ liệu từ api
                    $('#hdfId').val(item.Id);
                    $('input[name=txt-room-name-edit]').val(item.Name);
                    $('#ListBranch-edit').val(item.BranchId).change();
                    $('#ListFloor-edit').val(item.BranchFloor).change();
                    $('input[name=txt-room-price-edit]').val(format_money(item.Price));
                    $('input[name=txt-Acreage-edit]').val(item.Acreage);
                    $('input[name=txt-deposit-edit]').val(format_money(item.Deposit));
                    $('input[name=txt-BedAmount-edit]').val(item.BedAmount);
                    $('#ListRoomType-edit').val(item.RoomTypeId).change();
                    $('#room-status-edit').val(item.Status).change();
                    $('#modal-room-edit').modal('show');
                    //load_Room(PageIndex, PageSize, SearchContent, OrderBy, Status, RoomType);
                },
                error: function (xhr, status, error) {
                    alert("Result: " + status + " " + error + " " + xhr.status + " " + xhr.statusText)
                }
            });
        }
    // ghi điện
    function electricRecord(itemId) {
        roomid = itemId;
            //call api lay hoa don moi nhat
            let api_Electric_water_bill = 'api/ElectricWaterBill?RoomId=' + itemId + '&PageIndex=1&PageSize=20&OrderBy=0&TenantId=@Model.Users.Id';
            load_data_with_jquery(api_Electric_water_bill).then(function (e) {
                let list = e.Data.Items;
                console.log(list);
                // lay ra bill dau tien de lam so moi.
                $('#electric-old-number').val(list[0].NewNumberElectric);
                $('#water-old-number').val(list[0].NewNumberWater);
                // lấy giá điện nước
                let api_GetPrice_Electric_Water = 'api/Room/' + itemId;
                load_data_with_jquery(api_GetPrice_Electric_Water).then(function (e) {
                    let data = e.Data;
                    // gan vao modal
                    $('#electric-price-for-bill').val(format_money(data.ElectricPrice));
                    $('#water-price-for-bill').val(format_money(data.WaterPrice));
                })
            });
            $('#js-electronicNote').modal('show');
        }
        // bat su kien khi ghi dien
        $('.electric-water-update').on('click', function () {
            let old_electric = $('#electric-old-number').val();
            let new_electric=$('#electric-new-number').val();
            let old_water = $('#water-old-number').val();
            let new_water = $('#water-new-number').val();
            let img_electric = document.getElementById('image-electric').files[0];
            let img_water = document.getElementById('image-water').files[0];
            let price_electric = $('#electric-price-for-bill').val();
            let price_water = $('#water-price-for-bill').val();
            console.log(old_electric);
            console.log(new_electric);
            console.log(old_water);
            console.log(new_water);
            console.log(img_electric);
            console.log(img_water);
            if (ckstring(old_electric) || ckstring(new_electric) || ckstring(old_water) || ckstring(new_water) || img_electric.length == 0 || img_water.length == 0 ) {
                Swal.fire(
                    'Cảnh báo',
                    'Vui lòng nhập đầy đủ thông tin!',
                    'warning'
                )
            }
            else {
                let listImage = [];
                listImage.push(img_electric);
                listImage.push(img_water);
                let ImageNames = upload_img(listImage);
                //data
                let data = {};
                data["id"] = 0;
                data["deleted"] = false;
                data["active"] = true;
                data["roomId"] = roomid;
                data["electricPrice"] = price_electric;
                data["waterPrice"] = price_water;
                data["oldNumberElectric"] = old_electric;
                data["newNumberElectric"] = new_electric;
                data["oldNumberWater"] = old_water;
                data["newNumberWater"] = new_water;
                data["writeDate"] = new Date();
                data["waterImage"] = '@Model.Domain'+ImageNames[1];
                data["electricImage"] = '@Model.Domain' + ImageNames[0];
                //  giá tiền điện và nước (đổi từ kiểu string -> number)
                let eletric_price_edit = price_electric.replaceAll(",", "");
                let water_price_edit = price_electric.replaceAll(",", "");
                let electricBill = (new_electric - old_electric) * eletric_price_edit;
                let waterBill = (new_water - old_water) * water_price_edit;
                data["electricBill"] = electricBill;
                data["waterBill"] = waterBill;
                //api to create bill electricwater
                let api_Create_Electric_water_bill = 'api/ElectricWaterBill';
                $(this).prop('disabled', true);
                create_data(data, api_Create_Electric_water_bill);
                $('#js-electronicNote').modal('hide');
                location.reload(true);
            }
        })

        function moveOut(itemId) {
            $('#js-goOut').modal('show');
        }
</script>
<!--by baonguyen-->
<!-- xu ly modal tien ich-->
@await Html.PartialAsync("PartialView/_BaseScriptPartial")
<script>
    // nhan nut save
    $('.edit-room-service').on('click', function () {
        let data = {};
        let lsUtilitiesAndPrice = ListUtiliti_service.join(";");
        data["id"] = 0;
        data["deleted"] = false;
        data["active"] = true;
        data["roomid"] = roomid;
        data["listUtilitiesAndPrice"] = lsUtilitiesAndPrice;
        // tham so chuen vao gom: roomId, UltilitiesId, price
        let api_update_utilities_room = 'api/RoomUtilities/Update_Utilities_RoomService';
        create_data(data, api_update_utilities_room);
        // update gia dien nuoc
        let ElectricAndWaterPrice = {};
        ElectricAndWaterPrice["id"] = roomid;
        ElectricAndWaterPrice["electricPrice"] = $('#electric-price').val().replaceAll(',','');
        ElectricAndWaterPrice["waterPrice"] = $('#water-price').val().replaceAll(',', '');;
        let api_update_electic_water_price = 'api/Room';
        update_data(ElectricAndWaterPrice, api_update_electic_water_price);
    })
    //call api tien ich
    let api_utilitiConfig = 'api/UtilitiesConfig?PageIndex=1&PageSize=20&OrderBy=0&TenantId=@Model.Users.Id';

    let ListUtiliesConfig = [];
    load_data_with_jquery(api_utilitiConfig).then(function (e) {
        let list = e.Data.Items;
        let html = '';
        ListUtiliesConfig = list;
        for (var i = 0; i < list.length; i++) {
            let item = list[i];
            html += '<tr>';
            html += '<td>' + item.Name + '</td>';
            html += '<td><input id="RoomUtilitiesPrice-' + item.Id + '" data-type="currency"  class="form-control" value="' + format_money(item.Price) + '" /></td>';
            html += '<td>' +
                '<input type="checkbox" id="RoomUtilities-' + item.Id + '" data-price="'+item.Price+'" data-roomid="'+item.Id+'" onclick="RoomUtilitiesCheckBox(' + i + ')" ></td>';
            html += '</tr>';
        }
        $('#tbody-update-room-utilities').hide().html(html).show('slow');
    })

    let roomid = 0;
    let ListRoomUtilies = [];
    function EditServiceRoom(RoomID) {
        // call api Room Utilities
        roomid = RoomID;
        let api_RoomUtilities = 'api/RoomUtilities?PageIndex=1&PageSize=20&OrderBy=0&TenantId=@Model.Users.Id' + '&RoomId=' + RoomID;
        let call_api_RoomUtilities = load_data_with_jquery(api_RoomUtilities).then(function (e) {
            ListRoomUtilies = [];
            ListUtiliti_service = [];
            let list = e.Data.Items;
            ListRoomUtilies = list;
            RoomUtilitiesCheck();
            $('#js-edit-service').modal('show');
        })
        let api_Room_by_id = 'api/Room/' + RoomID;
        let call_api_Room_by_id = load_data_with_jquery(api_Room_by_id).then(function (e) {
            let data = e.Data;
            // gan vao modal
            $('#electric-price').val(format_money(data.ElectricPrice));
            $('#water-price').val(format_money(data.WaterPrice));
        })
    }
    let ListUtiliti_service = [];
    function RoomUtilitiesCheck() {
        if (ListRoomUtilies.length > 0) {
            for (var i = 0; i < ListUtiliesConfig.length; i++) {
                let tmp = false;
                var checkBox = document.getElementById("RoomUtilities-" + ListUtiliesConfig[i].Id);
                var input = document.getElementById("RoomUtilitiesPrice-" + ListUtiliesConfig[i].Id);
                for (var j = 0; j < ListRoomUtilies.length; j++) {
                    if (ListUtiliesConfig[i].Id == ListRoomUtilies[j].UtilitiesId) {
                        checkBox.checked = true;
                        ListUtiliti_service.push(ListUtiliesConfig[i].Id + ':' + input.value.replaceAll(',', ''));
                        input.value = format_money(ListRoomUtilies[j].Price);
                        input.readOnly = true;
                        tmp = true;
                        break;
                    }
                    else{
                        tmp = false;
                    }
                }
                if (tmp == false) {
                    checkBox.checked = false;
                    let index = ListUtiliti_service.indexOf(ListUtiliesConfig[i].Id + ':' + input.value.replaceAll(',', ''));
                    input.value = format_money(ListUtiliesConfig[i].Price);
                    if (index >= 0) {
                        ListUtiliti_service.splice(index, 1);
                    }
                    input.readOnly = false;
                }
            }
        }
        else {
            for (var i = 0; i < ListUtiliesConfig.length; i++) {
                var checkBox = document.getElementById("RoomUtilities-" + ListUtiliesConfig[i].Id);
                var input = document.getElementById("RoomUtilitiesPrice-" + ListUtiliesConfig[i].Id);

                checkBox.checked = false;
                let index = ListUtiliti_service.indexOf(ListUtiliesConfig[i].Id + ':' + input.value.replaceAll(',', ''));
                input.value = ListUtiliesConfig[i].Price;
                ListUtiliti_service.splice(index, 1);
                input.readOnly = false;
            }
        }
    }
    // kiem tra khi bat dau chin checkbox
    function RoomUtilitiesCheckBox(index) {
        for (let i = 0; i < ListUtiliesConfig.length; i++) {
            if (ListUtiliesConfig[i].Id == ListUtiliesConfig[index].Id) {
                var checkBox = document.getElementById("RoomUtilities-" + ListUtiliesConfig[i].Id);
                var input = document.getElementById("RoomUtilitiesPrice-" + ListUtiliesConfig[i].Id);

                if (checkBox.checked == true) {
                    ListUtiliti_service.push(ListUtiliesConfig[i].Id + ':' + input.value.replaceAll(',', ''));
                    input.readOnly = true;
                }
                else {
                    let index = ListUtiliti_service.indexOf(ListUtiliesConfig[i].Id + ':' + input.value.replaceAll(',', ''));
                    ListUtiliti_service.splice(index, 1);
                    input.readOnly = false;
                }
            }
        }
    }
</script>
<!---->
<!-- xu ly tien dien nuoc trong modal tien ich-->
<script>
    //#region Tính tiền phòng theo tháng


    // chọn năm, tự động là năm hiện tại, lâu nhất là 5 năm
    let get_current_year = new Date().getFullYear();
    let ddl_year = document.getElementById('ddl-year');
    for (let i = 0; i < 100; i++) {
        var opt = document.createElement('option');
        opt.value = get_current_year;
        opt.innerHTML ='Năm '+ get_current_year;
        get_current_year++;
        ddl_year.appendChild(opt);
    }
    // chọn tháng
    let ddl_month = document.getElementById('ddl-month');
    for (let i = 1; i <= 12; i++) {
        var opt = document.createElement('option');
        opt.value = i;
        opt.innerHTML ='Tháng '+ i;
        ddl_month.appendChild(opt);
    }
    function takeMoney(itemId) {
        $('#room-id-checkout-month').val(itemId);
        $('#ddl-month').val(new Date().getMonth()).change();
        $('#ddl-year').val(new Date().getFullYear()).change();
        // sau khi chọn ngày tháng năm kiểm tra
        // load phí dịch vụ của phòng
        checkout_room_ultilities(itemId);
        checkout_room_price(itemId);
        $('#js-payMoney').modal('show');
    }
    $('#ddl-month').on('change', function () {
        console.log('change month');
        checkout_room();
        // tính lai tổng tiền mỗi lân thay đổi tháng\

        @*let electric_bill = $('#electric-bill-with-month').html().replace(",","");
        let water_bill = $('#water-bill-with-month').html().replace(",", "");
        let room_utilities_bill = $('#room-utilities-bill').html().replace(",", "");
        let room_price_bill = $('#room-price-checkout').html().replace(",", "");
        console.log("electric:"+electric_bill);
        let total_money_checkout = electric_bill + water_bill + room_utilities_bill + room_price_bill;
        $('#total-money-checkout').html(format_money(total_money_checkout));*@

    });
    @*$('#ddl-year').on('change', function () {
        console.log('change year');
        checkout_room();
    });*@
    function checkout_room() {
        // lấy thông tin điện nước trả ra tiền điện nước tháng/ năm dó
        let roomId = $('#room-id-checkout-month').val();
        let month = $('#ddl-month').val();
        let year = $('#ddl-year').val();
        console.log(roomId, month, year);
        let api_get_electricwaterbillformonth = 'api/ElectricWaterBill/get_electric_water_bill_with_month?RoomId='+roomId+'&Month='+month+'&Year='+year;
        load_data_with_jquery(api_get_electricwaterbillformonth).then(function (e) {
            //danh sách tiền điện theo tháng
            // ở đây sẽ kiểm tra ngày vào và ra trọ của khách với ngày ghi điện
            // chưa có chức năng dọn vào nên để đó chưa làm :)))
            console.log(e.Data);
            let items = e.Data;
            let html = '';
            let electric_bill = 0;
            let water_bill = 0;
            for (let i = 0; i < items.length; i++) {
                let item = items[i];
                electric_bill += item.ElectricBill;
                water_bill += item.WaterBill;
                var date = new Date(item.WriteDate);
                let date_write = ((date.getDate() > 9) ? date.getDate() : ('0' + date.getDate())) + '/' + ((date.getMonth() > 8) ? (date.getMonth() + 1) : ('0' + (date.getMonth() + 1))) + '/' + date.getFullYear();
                html += `<tr>
                                    <td>`+ date_write +`</td>
                                    <td>`+ (item.NewNumberElectric - item.OldNumberElectric)+`</td>
                                    <td>`+ (item.NewNumberWater - item.OldNumberWater) + `</td>
                                    <td>`+ format_money(item.ElectricPrice) +`</td>
                                    <td>`+ format_money(item.WaterPrice) +`</td>
                                    <td>`+ format_money(item.ElectricBill) +`</td>
                                    <td>`+ format_money(item.WaterBill) +`</td>
                                </tr>`;
            }
            $('#electric-bill-with-month').html(format_money(electric_bill));
            $('#water-bill-with-month').html(format_money(water_bill));
            $('#electric-water-bill').html(html);
        })
        // lấy ra tổng tiền tháng đó
        let api_get_total_money_checkout = 'api/Room/CheckOutRoom?RoomId=' + roomId + '&Month=' + month + '&Year=' + year;
        load_data_with_jquery(api_get_total_money_checkout).then(function (e) {
            $('#total-money-checkout').html(format_money(e.Data));
            let total_money = e.Data;
            let price_sub = $('#price-subtract').val().replaceAll(",","");
            let price_plus = $('#price-plus').val().replaceAll(",", "");
            let total_money_after = parseFloat(total_money) - parseFloat(price_sub) + parseFloat(price_plus);
            $('#total-money-after-edit').html(format_money(total_money_after));
        })
    }
    function checkout_room_ultilities(roomId) {
        let api_get_roomutilities_formonth = 'api/RoomUtilities?RoomId=' + roomId + '&PageIndex=1&PageSize=20&OrderBy=0&TenantId=@Model.Users.Id';
        load_data_with_jquery(api_get_roomutilities_formonth).then(function (e) {
            console.log(e.Data);
            let items = e.Data.Items;
            let room_utilities_bill = 0;
            let html = '';
            for (let i = 0; i < items.length; i++) {
                let item = items[i];
                room_utilities_bill += item.Price;
                html += `<tr>
                                    <td>`+ item.UtilitiName + `</td>
                                    <td>`+ format_money(item.Price) + `</td>
                                </tr>`;
            }
            $('#room-utilities-bill').html(format_money(room_utilities_bill));
            $('#room-ultilities-checkout').html(html);
        })
    }
    function checkout_room_price(roomId) {
        let api_get_roomprice_formonth = 'api/Room/' + roomId;
        load_data_with_jquery(api_get_roomprice_formonth).then(function (e) {
            console.log(e.Data);
            let item = e.Data;
            $('#room-price-checkout').html(format_money(item.Price));
        })
    }
    $('#price-plus').on('change', function () {
        let total_money = $('#total-money-checkout').html().replaceAll(",", "");
        let price_sub = $('#price-subtract').val().replaceAll(",", "");
        let price_plus = $('#price-plus').val().replaceAll(",", "");
        console.log(total_money);
        console.log(price_plus);
        console.log(price_sub);
        let total_money_after = parseFloat(total_money) - parseFloat(price_sub) + parseFloat(price_plus);
        $('#total-money-after-edit').html(format_money(total_money_after));
    })
    $('#price-subtract').on('change', function () {
        let total_money = $('#total-money-checkout').html().replaceAll(",", "");
        let price_sub = $('#price-subtract').val().replaceAll(",", "");
        let price_plus = $('#price-plus').val().replaceAll(",", "");
        console.log(total_money);
        console.log(price_plus);
        console.log(price_sub);
        let total_money_after = parseFloat(total_money) - parseFloat(price_sub) + parseFloat(price_plus);
        $('#total-money-after-edit').html(format_money(total_money_after));
    })
    // lưu tính tiền thành hóa đơn với trạng thái đang chờ thanh toán
    $('.btn-checkout').on('click', function () {
        let roomId = $('#room-id-checkout-month').val();
        let month = $('#ddl-month').val();
        let year = $('#ddl-year').val();
        let plus_bill = $('#price-plus').val().replaceAll(",", "");
        let sub_bill = $('#price-subtract').val().replaceAll(",", "");
        let note_checkOut = $('#note-checkout').val();
        if (ckstring(month) || ckstring(year) || ckstring(plus_bill) || ckstring(sub_bill) || ckstring(roomId)) {
            Swal.fire(
                'Cảnh báo',
                'Vui lòng điền đầy đủ thông tin',
                'warning'
            )
        }
        else {
            let data = {};
            // Năm tháng mà người dùng muốn thanh toán
            let date = '1/' + month + '/' + year; // dd/mm/yyyy
            

            data["id"] = 0;
            data["roomId"] = roomId;
            data["date"] = date.split("/").reverse().join("-");
            data["plusBill"] = plus_bill;
            data["subBill"] = sub_bill;
            data["note"] = note_checkOut;
            data["status"] = 0; // chờ thanh toán
            data["deleted"] = false;
            data["active"] = true;

            let api_Create_roomReceipt = 'api/RoomReceipt';
            create_data(data, api_Create_roomReceipt).then(function (e) {
                console.log(e);
            })
        }
        
    })

    //#endregion
</script>
<!---->
